##################InstaScript Settings###################

#IF=%FirstTime,;
#SmoothBackground
_SetVar=CreateCharacters,1; // create as many characters as possible | 1 = Yes / 0 = No
_SetVar=DeleteCharacters,1; // Delete failed characters | 1 = Yes / 0 = No | (not recommended if you have high level characters on the same server)
_SetVar=UserCube,1; // Expand Inventory twice at the end | 1 = Yes / 0 = No
_SetVar=UserLuna,1; // Accept Luna quests | 1 = Yes / 0 = No
_SetVar=UserPIN,12345678; // Your PIN
_SetVar=HidePlayers,1; // Hides other Players | 1 = Yes / 0 = No
_SetVar=QuitClient,0; // exit aion when script finished | 1 = Yes / 0 = No
_SetVar=Obelisk,1; // Bind in Sanctum | 1 = Yes / 0 = No
_SetVar=PreDeclaredNames,2; // Create new Characternames by 0 = Random Generated | 1 = Retrieved from Namelist | 2 = Generated from online name generator
_SetVar=NewClass,7; // Create new Characters as 1 = Gladiator | 2 = Templar | 3 = Assassin | 4 = Ranger | 5 = Sorcerer | 6 = Spiritmaster | 7 = Cleric | 8 = Chanter | 9 = Gunslinger (Recommended) | 10 = Aethertech | 11 = Songweaver | 12 = Painter | 13 = Random
_SetVar=DiscordURL,0; // Enter your Discord Webhook URL for Discord messages, otherwise enter 0 ( more information at https://bit.ly/2Q1YcqY )
#EXECUTE=AccountSettings; // Scroll at the very end to setup account specific settings
#EXECUTE=InstaScriptLogin;
#ENDIF

##################END Settings###################




##############Your Main Code Here################

#IF=%FirstTime,;
#SmoothBackground
#UseGravity
#UseCollision
UseSpeed=1;
#EXECUTE=CheckInstaScript;
#EXECUTE=CheckUpdate;
MemPtrWrite=%AddrFPS,%OffsetFPS1,24,BYTE;FPS
MemPtrWrite=%AddrFPS,%OffsetFPS2,24,FLOAT;FPS
MemPtrWrite=%AddrCamMax,%OffsetCamMax,44,FLOAT;CAMMAX
#EXECUTE=DeclareStrings;
_ACMob_Looting=False;
_ACRegenerateEnabled=True;
Command=;
_SetVar=DeletedCharacters,0;
_SetVar=CreatedCharacters,0;
_SetVar=Sell,1; // sell items at the end
_SetVar=Luna,%Var[UserLuna];
_SetVar=Cube,%Var[UserCube];
_SetVar=Loop,%Var[CreateCharacters];
_SetVar=NewClassCache,%Var[NewClass];
#EXECUTE=PickClass;
#ENDIF

_SetVar=MSG,Script got started at %THour:%TMin:%TSec;
#EXECUTE=DiscordPost;

#IF=%Var[Loop],=1;
_SetVar=PIN,%Var[UserPIN];
#EXECUTE=MultiRun;
#ELSE
#EXECUTE=SingleRun;
#ENDIF





start_MultiRun;

#DO=9999999999;

_IFMemRead=%AddrCharacterScene,BYTE,=5;<-CharacterScene
#EXECUTE=Main;
#ENDIF

_IFMemRead=%AddrCharacterScene,BYTE,=5;<-CharacterScene
#EXECUTE=GoToCharScreen;
#ENDIF

_IFMemRead=%AddrCharacterScene,BYTE,=0;<-CharacterScene
#EXECUTE=CreateCharacter;
#ENDIF

#EXECUTE=LogOnCharacter;

#UNTIL=1,=2;

end_MultiRun;


start_SingleRun;

FlySmooth=873,1186,111;
Delay=750;
#IF=%Position,873/1186/111;
#EXECUTE=Main;
#ELSE
#EXECUTE=End;
#ENDIF

end_SingleRun;


start_PickClass;

#IF=%Var[NewClass],=1;
_SetVar8=1;
#ENDIF

#IF=%Var[NewClass],=2;
_SetVar8=2;
#ENDIF

#IF=%Var[NewClass],=3;
_SetVar8=1;
#ENDIF

#IF=%Var[NewClass],=4;
_SetVar8=2;
#ENDIF

#IF=%Var[NewClass],=5;
_SetVar8=1;
#ENDIF

#IF=%Var[NewClass],=6;
_SetVar8=2;
#ENDIF

#IF=%Var[NewClass],=7;
_SetVar8=1;
#ENDIF

#IF=%Var[NewClass],=8;
_SetVar8=2;
#ENDIF

#IF=%Var[NewClass],=9;
_SetVar8=1;
#ENDIF

#IF=%Var[NewClass],=10;
_SetVar8=2;
#ENDIF

#IF=%Var[NewClass],=11;
_SetVar8=1;
#ENDIF

#IF=%Var[NewClass],=12;
_SetVar8=2;
#ENDIF

#IF=%Var[NewClass],=13; // Random Class
_SetVar=NewClass,%RNG{1|12};
#EXECUTE=PickClass;
#ENDIF

end_PickClass;



start_Main;

SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window
MemPtrWrite=%AddrFrameName[dailymission_dialog],0x28,142,BYTE; Hide Lugbug mission window
MemPtrWrite=%AddrFrameName[promotion_dialog],0x28,142,BYTE; Hide Event window
_SetVar=CheckArtistWeapon,0;

#IF=%Var[HidePlayers],=1;
#EXECUTE=HidePlayers;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetLevel,BYTE,>9;
_SetVar=MSG,Accidently logged on already leveled character, creating new character now;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#IF=%Var[NewClass],=11; // Songweaver
_IFMemRead=%AddrAtkspeed,WORD,<2400;
_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=15; <- Muse
Command=/Use %Var[Old Stringed Instrument];
Delay=500;
#ENDIF

#EXECUTE=DisableClickToMove;
#EXECUTE=DisableAllInvitesForLeveling;

_SetVar=MSG,has started leveling;
#EXECUTE=DiscordPost;

FlySmooth=865.316,1201.278,115.862;
FlySmooth=862.808,1207.295,117.496;
FlySmooth=861.979,1213.579,118.625;

#DO=30000;
Command=/select %Var[Old Friend Royer];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=858.853,1224.528,118.625;
FlySmooth=857.331,1237.356,119.09;
FlySmooth=864.767,1249.473,119.134;

#DO=30000;
Command=/select %Var[Pernos];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window

_IFQuestAtStatus=60001,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 1 - Couldn't finish %Var[Quest60000];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#DO=30000;
Command=/select %Var[Pernos];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=862.468,1251.176,119.134;
FlySmooth=864.641,1254.861,119.133;

#DO=90000;
Command=/select %Var[Guide to Rare Poisons];
Delay=125;
Command=/attack;
Delay=1250;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
DialogClick=;
Delay=5000;
SendKey=0x1B;
Delay=1000;
DialogClick=;
Delay=750;
DialogClick=;
Delay=750;
DialogClick=;
Delay=750;
DialogClick=;
Delay=750;
DialogClick=;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=868.514,1252.946,119.176;

#DO=90000;
Command=/select %Var[Day of the Storm];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
Mouse=249,369;
Delay=25;
Mouse=252,369;
Delay=25;
Mouse=254,369;
Delay=25;
DialogClick=;
Delay=650;
Mouse=249,369;
Delay=25;
Mouse=252,369;
Delay=25;
Mouse=254,369;
Delay=25;
DialogClick=;
Delay=650;
Mouse=249,369;
Delay=25;
Mouse=252,369;
Delay=25;
Mouse=254,369;
Delay=25;
DialogClick=;
Delay=650;
DialogClick=;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=869.686,1250.557,119.133;
FlySmooth=867.347,1248.933,119.134;

#DO=30000;
Command=/select %Var[Pernos];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window

_IFQuestAtStatus=60003,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 2 - Couldn't finish %Var[Quest60001];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=860.959,1242.651,119.135;
FlySmooth=856.331,1234.526,118.75;
FlySmooth=864.318,1234.397,118.675;

#DO=30000;
Command=/select %Var[Kasis];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=60000;
Command=/select %Var[Exam Scarecrow];
Delay=125;
Command=/attack;
Delay=1000;
_UNTILMemPtrRead=%PlayerBase,%OffsetLevel,BYTE,>2;

#DO=5000;
Command=/select %Var[Exam Scarecrow];
Delay=125;
Command=/attack;
Delay=1000;
_UNTILMemPtrRead=%PlayerBase,%OffsetLevel,BYTE,>3;

#DO=30000;
Command=/select %Var[Kasis];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window

_IFQuestAtStatus=60004,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 3 - Couldn't finish %Var[Quest60003];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

UseID=160040083;

#DO=30000;
Command=/select %Var[Kasis];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=select3;
Delay=650;
DialogClick=select1;
Delay=650;
DialogClick=select2;
Delay=650;
DialogClick=;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window

_IFQuestAtStatus=60005,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 4 - Couldn't finish %Var[Quest60004];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=CheckGear;

FlySmooth=854.105,1234.178,118.643;
FlySmooth=841.953,1236.771,118.67;
FlySmooth=824.812,1239.621,118.75;
FlySmooth=821.454,1240.836,118.716;

#DO=30000;
Command=/select %Var[Kalio];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=450;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=821.164,1234.448,118.625;
FlySmooth=821.675,1222.662,118.291;
FlySmooth=822.585,1210.975,115.873;
FlySmooth=822.416,1199.275,112.784;
FlySmooth=817.547,1189.152,110.284;
FlySmooth=806.738,1185.373,107.685;
FlySmooth=794.963,1186.596,106.236;
FlySmooth=786.424,1187.355,106.085;

#DO=30000;
Command=/select %Var[Melampus];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#EXECUTE=ChangeChannel;
MemPtrWrite=%AddrThirdPerson,%OffsetThirdPerson,20,FLOAT;THIRDPERSON
#EXECUTE=CombatSort;

FlySmooth=780.831,1184.572,105.75;
FlySmooth=780.831,1184.572,105.75;
FlySmooth=778.253,1190.845,106.345;
FlySmooth=774.251,1198.948,106.809;
FlySmooth=768.919,1206.208,107.401;
FlySmooth=765.006,1214.312,108.227;

SendKey=0x1B;
Delay=15;
SendKey=0x1B;
Delay=15;

_ACMob_Whitelist=Smallhorn Kerub,Bigfoot Kerubar;
#DO=1800000;
MemWrite=%AddrCamY,17,FLOAT;
#EXECUTE=FarmSpot1;
_IFQuestAtStep=60005,3;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;
_ACMob_Blacklist=--,--;

FlySmooth=765.006,1214.312,108.227;
FlySmooth=754.8,1218.557,109.154;
FlySmooth=745.917,1220.252,109.511;
FlySmooth=737.011,1220.8,110.012;
FlySmooth=728.129,1218.807,110.407;
FlySmooth=719.466,1216.558,109.582;
FlySmooth=711.075,1213.154,107.639;
FlySmooth=702.843,1209.391,107.925;
FlySmooth=694.769,1205.375,108.547;
FlySmooth=686.486,1201.827,108.34;
FlySmooth=678.945,1196.883,107.75;
FlySmooth=670.288,1195.41,107.75;
FlySmooth=662.729,1200.09,107.875;
FlySmooth=656.924,1207,108;
FlySmooth=651.638,1214.221,108.469;
FlySmooth=646.343,1221.615,108.949;
FlySmooth=641.337,1229.297,109.169;
FlySmooth=641.178,1229.541,109.154;

#DO=30000;
Command=/select %Var[Acting Royer];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

_IFQuestAtStatus=60005,4;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 5 - Couldn't finish %Var[Quest60005];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=640.774,1229.909,109.131;
FlySmooth=633.694,1234.879,109.574;
FlySmooth=628.485,1242.114,110.257;
FlySmooth=624.401,1250.094,110.475;
FlySmooth=616.571,1254.256,110.714;
FlySmooth=605.014,1256.389,110.463;
FlySmooth=595.226,1262.516,109.875;
FlySmooth=587.89,1271.512,109.75;
FlySmooth=582.814,1282.027,110.303;
FlySmooth=581.562,1293.668,111.382;
FlySmooth=580.902,1305.376,112.827;
FlySmooth=580.249,1316.991,114.493;
FlySmooth=578.447,1328.647,115.762;
FlySmooth=574.045,1339.552,116.472;
FlySmooth=569.543,1350.263,117.828;
FlySmooth=564.966,1361.154,119.637;
FlySmooth=560.54,1371.996,119.969;
FlySmooth=559.167,1375.373,119.966;

#DO=30000;
Command=/select %Var[Forest Protector Noah];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window

_IFQuestAtStatus=60006,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 6 - Couldn't finish %Var[Quest60005];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=CheckGear;

#DO=30000;
Command=/select %Var[Forest Protector Noah];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=561.073,1378.178,119.614;
FlySmooth=562.733,1389.644,117.032;
FlySmooth=563.77,1401.45,113.109;
FlySmooth=565.997,1412.767,113.173;
FlySmooth=570.283,1423.849,113.384;
FlySmooth=574.682,1434.654,111.502;
FlySmooth=583.533,1442.187,110.363;
FlySmooth=593.426,1448.709,112.4;
FlySmooth=602.207,1456.31,115.11;
FlySmooth=605.96,1467.429,117.676;
FlySmooth=606.418,1472.835,118.38;

#DO=30000;
Command=/select %Var[Rooted Elder];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=606.933,1472.557,118.378;
FlySmooth=608.257,1481.714,119.339;
FlySmooth=611.124,1493.024,117.628;
FlySmooth=613.254,1504.563,116.645;
FlySmooth=614.879,1516.082,117.545;
FlySmooth=616.52,1527.74,117.114;
FlySmooth=615.987,1539.468,115.874;
FlySmooth=617.169,1551.145,116;
FlySmooth=620.527,1562.321,116.678;
FlySmooth=624.246,1573.506,118.344;
FlySmooth=624.168,1585.231,117.721;
FlySmooth=622.149,1596.84,117.625;
FlySmooth=615.566,1605.596,117.176;
FlySmooth=604.225,1608.452,116.472;
FlySmooth=592.723,1606.547,116.33;
FlySmooth=581.225,1603.955,114.912;
FlySmooth=569.864,1600.945,116.201;
FlySmooth=558.696,1598.385,115.376;
FlySmooth=548.633,1601.433,114.742;
FlySmooth=548.714,1606.025,116.094;

#DO=30000;
Command=/select %Var[Branching Elder];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

_IFQuestAtStep=60006,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 7 - Couldn't finish %Var[Quest60006];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=CombatSort;

FlySmooth=557.823,1615.355,116.728;
FlySmooth=565.527,1622.473,115.036;
FlySmooth=576.598,1632.725,117.125;
FlySmooth=573.962,1638.838,117.125;

SendKey=0x1B;
Delay=15;
SendKey=0x1B;
Delay=15;

#DO=1800000;
MemWrite=%AddrCamY,17,FLOAT;
#EXECUTE=FarmSpot2;
_IFQuestInventoryContains=182216249,1;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;

_ACDetectIfAttacked=;
FlySmooth=573.962,1638.838,117.125;
_ACDetectIfAttacked=;
FlySmooth=580.905,1644.147,117.584;
_ACDetectIfAttacked=;
FlySmooth=585.297,1658.22,123.427;
_ACDetectIfAttacked=;
FlySmooth=583.881,1659.223,123.77;
_ACDetectIfAttacked=;
FlySmooth=581.319,1659.07,123.381;
_ACDetectIfAttacked=;

#EXECUTE=SheatheWeapon;
MoveTo=581.319,1657.07,128.381,True,False;

#DO=30000;
Command=/select %Var[Leafy Elder];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

_IFQuestAtStep=60006,5;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 8 - Couldn't finish %Var[Quest60006];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

MoveTo=581.319,1657.07,128.381,True,False;

#DO=45000;
Command=/Use %Var[Daminu Flute];
Delay=6000;
#UNTIL=%Position,499/1532/104.938;

MoveTo=499,1532,104.938,False,False;

#DO=60000;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
Command=/select %Var[Daminu];
Delay=125;
Command=/attack;
Delay=4000;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
DialogClick=;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window

_IFQuestAtStatus=60007,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 9 - Couldn't finish %Var[Quest60006];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=CheckGear;

#DO=30000;
Command=/select %Var[Daminu];
Delay=125;
Command=/attack;
Delay=4000;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=503.096,1537.485,105.629;
FlySmooth=510.249,1542.919,108.032;
FlySmooth=515.532,1550.271,109.796;
FlySmooth=519.413,1558.294,110.875;
FlySmooth=518.397,1567.196,111.675;
FlySmooth=514.038,1575.126,112.618;
FlySmooth=511.029,1583.686,113.973;
FlySmooth=508.304,1592.368,115.758;
FlySmooth=505.684,1601.03,117.085;
FlySmooth=503.03,1609.688,117.375;
FlySmooth=500.395,1618.338,117.5;
FlySmooth=497.768,1626.966,117.9;
FlySmooth=495.127,1635.636,120.55;
FlySmooth=492.49,1644.296,122.756;
FlySmooth=489.842,1652.99,124.186;
FlySmooth=487.37,1661.588,125.393;
FlySmooth=485.13,1669.743,125.859;
FlySmooth=482.42,1678.947,125.105;
FlySmooth=479.342,1687.51,123.27;
FlySmooth=476.075,1695.934,122.132;
FlySmooth=472.575,1704.28,120.715;
FlySmooth=468.76,1712.504,118.906;
FlySmooth=464.931,1720.711,117.491;
FlySmooth=460.813,1728.67,116.902;
FlySmooth=456.43,1736.589,117.432;
FlySmooth=450.19,1743.147,119.351;
FlySmooth=446.286,1746.098,119.607;
FlySmooth=442.295,1748.574,119.75;
FlySmooth=434,1751.571,119.75;
FlySmooth=429.143,1753.628,119.75;
FlySmooth=430.025,1754.984,119.75;

#DO=30000;
Command=/select %Var[Investigating Royer];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

_IFQuestAtStep=60007,2;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 10 - Couldn't finish %Var[Quest60007];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=CombatSort;

FlySmooth=431.648,1756.772,119.75;
FlySmooth=437.306,1763.835,120.071;
FlySmooth=441.2,1771.99,121.648;
FlySmooth=444.496,1780.601,123.894;
FlySmooth=448.829,1790.81,125.352;
FlySmooth=450.306,1801.816,126.758;
FlySmooth=444.059,1811.647,128.163;
FlySmooth=441.096,1823.025,132.311;
FlySmooth=441.438,1834.842,136.015;
FlySmooth=437.651,1843.503,137.063;
_ACDetectIfAttacked=;
FlySmooth=427.551,1849.451,138.356;
_ACDetectIfAttacked=;
FlySmooth=421.79,1852.81,139.902;
_ACDetectIfAttacked=;

SendKey=0x1B;
Delay=15;
SendKey=0x1B;
Delay=15;

UseID=160040083;
_SetVar=temp,0;
#DO=1800000;
MemWrite=%AddrCamY,17,FLOAT;
#EXECUTE=FarmSpot3;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;

#IF=%Var[temp],=1; // finished early;
FlySmooth=300.362,1982.681,155.355;
_ACDetectIfAttacked=;
FlySmooth=294.234,1992.839,158.113;
_ACDetectIfAttacked=;
FlySmooth=288.653,2004.167,160.304;
_ACDetectIfAttacked=;
FlySmooth=289.199,2017.422,161.103;
_ACDetectIfAttacked=;
FlySmooth=299.044,2028.518,160.328;
_ACDetectIfAttacked=;
FlySmooth=305.564,2041.025,161.89;
_ACDetectIfAttacked=;
FlySmooth=303.207,2052.014,168.329;
_ACDetectIfAttacked=;
FlySmooth=296.755,2056.13,169.75;
_ACDetectIfAttacked=;
FlySmooth=290.445,2065.155,169.75;
_ACDetectIfAttacked=;
FlySmooth=290.863,2072.701,169.75;
_ACDetectIfAttacked=;
#ELSE
FlySmooth=422.237,1853.946,139.946;
_ACDetectIfAttacked=;
FlySmooth=414.673,1857.578,142.295;
_ACDetectIfAttacked=;
FlySmooth=404.359,1862.381,145.129;
_ACDetectIfAttacked=;
FlySmooth=394.455,1868.592,146.574;
_ACDetectIfAttacked=;
FlySmooth=385.79,1876.425,147.304;
_ACDetectIfAttacked=;
FlySmooth=377.087,1884.379,148.139;
_ACDetectIfAttacked=;
FlySmooth=369.197,1893.155,149.486;
_ACDetectIfAttacked=;
FlySmooth=362.877,1903.018,150.755;
_ACDetectIfAttacked=;
FlySmooth=357.087,1913.309,152.039;
_ACDetectIfAttacked=;
FlySmooth=353.006,1924.234,153.126;
_ACDetectIfAttacked=;
FlySmooth=349.728,1935.467,153.666;
_ACDetectIfAttacked=;
FlySmooth=346.525,1946.865,154.217;
_ACDetectIfAttacked=;
FlySmooth=343.357,1958.137,154.79;
_ACDetectIfAttacked=;
FlySmooth=340.103,1969.315,154.631;
_ACDetectIfAttacked=;
FlySmooth=337.545,1980.861,154.611;
_ACDetectIfAttacked=;
FlySmooth=333.988,1992.103,155.624;
_ACDetectIfAttacked=;
FlySmooth=327.133,2001.626,154.946;
_ACDetectIfAttacked=;
FlySmooth=320.013,2011.014,155.5;
_ACDetectIfAttacked=;
FlySmooth=314.365,2021.224,157.857;
_ACDetectIfAttacked=;
FlySmooth=309.828,2032.286,158.314;
_ACDetectIfAttacked=;
FlySmooth=307.01,2043.537,163.079;
_ACDetectIfAttacked=;
FlySmooth=300.676,2052.957,169.066;
_ACDetectIfAttacked=;
FlySmooth=291.115,2059.823,169.739;
_ACDetectIfAttacked=;
FlySmooth=291.005,2071.434,169.75;
_ACDetectIfAttacked=;
FlySmooth=290.863,2072.701,169.75;
_ACDetectIfAttacked=;
#ENDIF

#DO=30000;
Command=/select %Var[Implementer Royer];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

_IFQuestAtStep=60007,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 11 - Couldn't finish %Var[Quest60007];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

Command=/select %Var[Odium Cauldron];
Delay=125;
Command=/attack;
Delay=5500;

#DO=30000;
Command=/select %Var[Implementer Royer];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#EXECUTE=CombatSort;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window

_IFQuestAtStatus=60008,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 12 - Couldn't finish %Var[Quest60007];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=CheckGear;
#EXECUTE=CombatSort;

FlySmooth=287.499,2080.873,170.358;

#DO=30000;
Command=/select %Var[First Odium Transport Track];
Delay=125;
Command=/attack;
Delay=4000;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

_IFQuestAtStep=60008,1;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 13 - Couldn't finish %Var[Quest60008];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=288.829,2083.629,170.955;
FlySmooth=289.601,2083.363,170.826;
FlySmooth=283.546,2085.822,171.081;
FlySmooth=278.754,2086.903,171.488;
FlySmooth=272.263,2088.188,171.441;
FlySmooth=266.084,2090.316,170.026;
FlySmooth=259.323,2091.214,167.182;
FlySmooth=254.677,2091.277,164.202;
FlySmooth=249.144,2091.271,160.552;
FlySmooth=245.453,2096.032,158.621;
FlySmooth=248.506,2099.168,157.99;
_ACCheckMob=;
FlySmooth=253.52,2103.891,157.224;
FlySmooth=256.171,2107.075,157;
_ACCheckMob=;
FlySmooth=265.771,2117.084,157.611;
_ACCheckMob=;
FlySmooth=263.313,2121.688,157.582;
_ACCheckMob=;

#DO=90000;
_ACDetectIfAttacked=;
Delay=200;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=500;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
Command=/select %Var[Second Odium Transport Track];
Delay=125;
Command=/attack;
Delay=4000;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

_IFQuestAtStep=60008,2;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 14 - Couldn't finish %Var[Quest60008];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=263.465,2123.238,157.669;
FlySmooth=260.517,2129.949,157.847;
FlySmooth=258.316,2138.745,157.632;
FlySmooth=255.991,2147.423,158.585;
_ACCheckMob=;
SendAction=3,2;
FlySmooth=257.233,2153.51,159.86;
SendAction=3,2;
FlySmooth=257.233,2153.51,159.86;
SendAction=3,2;
FlySmooth=263.159,2159.864,162.969;
SendAction=3,2;
FlySmooth=263.159,2159.864,162.969;
_ACIgnoreAtDistance=9;
_ACCheckMob=;
FlySmooth=271.301,2163.688,163.84;
FlySmooth=278.858,2168.587,165.631;
_ACCheckMob=;
FlySmooth=283.821,2173.122,165.679;

#DO=30000;
Command=/select %Var[Ino];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window

_IFQuestAtStatus=60009,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 15 - Couldn't finish %Var[Quest60008];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

SendKey=0x1B;
Delay=15;
SendKey=0x1B;
Delay=15;

#EXECUTE=CheckGear;

FlySmooth=278.605,2171.301,165.354;
_ACCheckMob=;
FlySmooth=276.571,2173.859,165.441;
FlySmooth=272.886,2180.465,166.78;

#DO=90000;
_ACDetectIfAttacked=;
Delay=200;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=500;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
Command=/select %Var[Third Odium Transport Track];
Delay=125;
Command=/attack;
Delay=4000;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

_IFQuestAtStep=60009,1;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 16 - Couldn't finish %Var[Quest60009];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

_ACIgnoreAtDistance=25;
FlySmooth=272.387,2182.223,166.986;
FlySmooth=270.048,2190.906,169.861;
FlySmooth=268.813,2199.854,173.913;
FlySmooth=269.501,2208.76,174.956;
FlySmooth=272.764,2217.228,175.205;
FlySmooth=274.036,2226.182,174.924;
_ACCheckMob=;
FlySmooth=274.581,2235.188,174.183;
FlySmooth=275.381,2244.177,173.388;
FlySmooth=276.776,2252.911,175.322;
_ACCheckMob=;
FlySmooth=272.58,2260.081,178.077;
FlySmooth=263.721,2261.005,180.402;
FlySmooth=254.697,2260.578,182.001;
_ACCheckMob=;
FlySmooth=245.577,2260.454,183.609;
FlySmooth=238.721,2260.69,184.166;
FlySmooth=235.709,2267.364,185.073;
_ACCheckMob=;
FlySmooth=233.694,2271.907,187.395;

MemWrite=%AddrCamY,85,FLOAT;
#DO=60000;
_ACDetectIfAttacked=;
Command=/select %Var[Haramel Secret Entrance];
Delay=125;
Command=/attack;
Delay=8000;
_IFFrameVisibleByName=dlg_dialog;
DialogClick=select1;
#ENDIF
Delay=1800;
Command=/select %Var[Haramel Secret Entrance];
Delay=125;
Command=/attack;
Delay=8000;
_IFFrameVisibleByName=dlg_dialog;
DialogClick=select1;
#ENDIF
Delay=13000;
#UNTIL=%Position,178.707/20.82/144.224;

MemPtrWrite=%AddrFrameName[spinel_indun_buff_dialog],0x28,142,BYTE; Hide Buff window

_IFQuestAtStep=60009,2;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 17 - Couldn't finish %Var[Quest60009];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=174.107,20.864,144.225;
FlySmooth=165.106,20.976,144.228;
FlySmooth=156.081,21.487,144.233;
FlySmooth=147.063,21.413,144.242;
FlySmooth=142.573,21.199,144.245;

#DO=30000;
Command=/select %Var[Royer];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

_IFQuestAtStep=60009,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 18 - Couldn't finish %Var[Quest60009];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=145.653,24.654,144.243;
FlySmooth=148.384,32.966,144.239;
FlySmooth=149.118,41.907,144.279;

#EXECUTE=CombatSort;
#EXECUTE=Haramel;
#EXECUTE=CombatSort;

FlySmooth=870.363,1191.262,112.745;
FlySmooth=866.335,1199.293,115.302;
FlySmooth=862.945,1207.781,117.634;
FlySmooth=861.823,1216.642,118.625;
FlySmooth=862.912,1225.697,118.625;
FlySmooth=863.973,1234.614,118.6;
FlySmooth=863.65,1234.794,118.746;

#DO=90000;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
Command=/select %Var[Kasis];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
DialogClick=;
Delay=650;
Mouse=250,370;
Delay=25;
Mouse=252,370;
Delay=25;
Mouse=254,370;
Delay=25;
Mouse=248,370;
Delay=125;
Mouse=250,370;
Delay=25;
Mouse=252,370;
Delay=25;
Mouse=254,370;
Delay=25;
Mouse=248,370;
Delay=500;
Mouse=126,308;
Delay=350;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window

_IFQuestAtStatus=1006,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 24 - Couldn't finish %Var[Quest60009];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#DO=30000;
Command=/select %Var[Kasis];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=45000;
Command=/Use %Var[Daminu Flute];
Delay=6000;
#UNTIL=%Position,499/1532/104.938;

#IF=%Position,499/1532/104.938;
#ELSE
_SetVar=MSG,Couldn't use Daminu Flute - Couldn't finish %Var[Quest1006];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#DO=30000;
Command=/select %Var[Daminu];
Delay=125;
Command=/attack;
Delay=5500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
DialogClick=;
Delay=4500;
SendKey=0x1B;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

Delay=4500;

_IFQuestAtStep=1006,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 25 - Couldn't finish %Var[Quest1006];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#DO=30000;
Command=/select %Var[Kasis];
Delay=125;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=30000;
Delay=500;
#UNTIL=%Position,53.68/177/229.046;
Delay=2500;

#IF=%Position,53.68/177/229.046;
#ELSE
_SetVar=MSG,Couldn't teleport to Karamatis - Couldn't finish %Var[Quest1006];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=55.593,177.778,228.884;
FlySmooth=63.896,181.655,228.815;
FlySmooth=72.198,185.38,228.583;
FlySmooth=80.529,188.722,230.911;
FlySmooth=84.91,190.454,231.49;

#DO=30000;
Command=/select %Var[Belpartan];
Delay=125;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=60000;
Delay=500;
#UNTIL=%Position,218.85/250.49/206.701;
Delay=1500;

#EXECUTE=CombatFinal;

Delay=5000;

SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;

_IFQuestAtStep=1006,5;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 26 - Couldn't finish %Var[Quest1006];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#DO=120000;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
Command=/select %Var[Kasis];
Delay=125;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=250;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
DialogClick=;
Delay=750;
DialogClick=;
Delay=750;
DialogClick=select%Var8;
Delay=1200;
DialogClick=;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=250;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=30000;
Delay=500;
#UNTIL=%Position,862.56/1233.658/118.715;
Delay=1500;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; Hide Quest Detail window

_IFQuestAtStatus=60100,3;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 27 - Couldn't finish %Var[Quest1006];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#DO=30000;
Command=/select %Var[Kasis];
Delay=125;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=select2;
Delay=650;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=30000;
Delay=500;
#UNTIL=%Position,1324/1512/567.875;
Delay=1500;

#IF=%Position,1324/1512/567.875;
#ELSE
_SetVar=MSG,Couldn't teleport to Sanctum;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=CheckGear;

#IF=%Var[Luna],=1;
#EXECUTE=AcceptLuna;
#ENDIF

#IF=%Var[Sell],=1;
#EXECUTE=SellToInventory;
#ENDIF

#IF=%Var[Obelisk],=1;
#EXECUTE=BindToObelisk;
#ENDIF

#IF=%Var[HidingLocation],=1;
FlySmooth=1365.358,1514.66,569.183;
FlySmooth=1368.737,1520.909,569.181;
FlySmooth=1374.882,1523.72,569.189;
FlySmooth=1382.785,1523.132,570.415;
FlySmooth=1390.66,1522.418,572.95;
FlySmooth=1397.927,1519.522,572.994;
FlySmooth=1404.724,1515.433,573.143;
FlySmooth=1411.748,1511.798,573.332;
FlySmooth=1419.632,1510.732,573.33;
FlySmooth=1427.496,1510.639,573.33;
FlySmooth=1435.189,1512.23,573.334;
FlySmooth=1439.976,1518.755,573.072;
FlySmooth=1442.458,1526.272,573.072;
FlySmooth=1445.217,1533.672,573.072;
FlySmooth=1448.245,1540.959,573.325;
FlySmooth=1451.999,1548.419,574.324;
FlySmooth=1455.844,1555.332,572.876;
FlySmooth=1459.915,1562.112,572.876;
FlySmooth=1463.981,1568.882,572.876;
FlySmooth=1468.055,1575.667,572.875;
FlySmooth=1472.34,1582.804,572.874;
FlySmooth=1476.413,1589.586,572.872;
FlySmooth=1480.123,1596.54,572.871;
FlySmooth=1476.509,1603.227,573.069;
FlySmooth=1470.992,1609.498,572.884;
FlySmooth=1465.766,1615.42,572.884;
FlySmooth=1460.549,1621.332,572.884;
FlySmooth=1455.328,1627.578,572.884;
FlySmooth=1449.815,1633.494,572.884;
FlySmooth=1449.777,1640.499,572.884;
FlySmooth=1455.865,1645.516,573.155;
FlySmooth=1462.04,1650.425,573.155;
FlySmooth=1468.216,1655.334,573.155;
FlySmooth=1474.682,1659.719,573.155;
FlySmooth=1482.696,1661.634,573.272;
FlySmooth=1485.155,1654.468,573.232;
FlySmooth=1485.985,1651.521,573.229;
#ENDIF

#IF=%Var[Cube],=1;
#EXECUTE=ExpandInventory;
#ENDIF

FlySmooth=1359.92,1511.75,569.12;
FlySmooth=1374.24,1499.15,569.18;
FlySmooth=1395.81,1502.39,572.99;
FlySmooth=1393.03,1512.31,572.99;

#DO=30000;
Command=/select %Var[Leah];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=QuestSelect60100;
Delay=650;
DialogClick=;
Delay=2000;
SendKey=0x1B;
Delay=1000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=1397.291,1503.489,572.994;
FlySmooth=1397.291,1503.489,572.994;
FlySmooth=1403.513,1505.601,572.994;
FlySmooth=1409.675,1507.693,573.292;
FlySmooth=1416.117,1509.869,573.329;
FlySmooth=1422.439,1510.988,573.33;
FlySmooth=1429.089,1511.455,573.33;
FlySmooth=1435.465,1513.545,573.326;
FlySmooth=1439.451,1518.75,573.141;
FlySmooth=1442.13,1524.691,573.072;
FlySmooth=1445.168,1530.774,573.072;
FlySmooth=1448.019,1536.6,573.072;
FlySmooth=1450.869,1542.475,573.834;
FlySmooth=1453.816,1548.574,574.313;
FlySmooth=1456.646,1554.428,572.876;
FlySmooth=1459.598,1560.534,572.876;
FlySmooth=1462.54,1566.621,572.876;
FlySmooth=1465.365,1572.464,572.876;
FlySmooth=1468.278,1578.491,572.875;
FlySmooth=1471.185,1584.366,572.874;
FlySmooth=1474.323,1590.062,572.873;
FlySmooth=1477.491,1596.099,572.872;
FlySmooth=1478.93,1602.272,573.069;
FlySmooth=1474.328,1607.131,573.069;
FlySmooth=1469.755,1611.752,572.884;
FlySmooth=1464.98,1616.577,572.884;
FlySmooth=1460.403,1621.203,572.884;
FlySmooth=1455.63,1626.026,572.884;
FlySmooth=1450.851,1630.856,572.884;
FlySmooth=1446.436,1635.632,572.884;
FlySmooth=1443.158,1641.321,572.884;
FlySmooth=1440.926,1647.741,572.884;
FlySmooth=1439.075,1654.275,573.033;
FlySmooth=1435.561,1659.54,572.884;
FlySmooth=1429.931,1662.775,572.884;
FlySmooth=1423.638,1665.298,572.884;
FlySmooth=1417.547,1667.621,572.884;
FlySmooth=1412.021,1671.442,572.884;
FlySmooth=1407.428,1676.056,572.884;
FlySmooth=1402.844,1680.888,572.884;
FlySmooth=1398.054,1685.475,573.123;
FlySmooth=1393.301,1690.302,573.286;
FlySmooth=1391.784,1691.842,573.286;

#DO=30000;
Command=/select %Var[Jucleas];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
DialogClick=;
Delay=2000;
SendKey=0x1B;
Delay=1000;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=1394.197,1691.902,573.286;
FlySmooth=1397.571,1685.61,573.123;
FlySmooth=1404.446,1678.594,572.884;
FlySmooth=1411.41,1671.413,572.884;
FlySmooth=1416.163,1662.833,572.884;
FlySmooth=1419.217,1653.438,572.884;
FlySmooth=1423.204,1644.321,572.884;
FlySmooth=1431.218,1638.88,572.884;
FlySmooth=1440.641,1635.878,572.884;
FlySmooth=1449.144,1630.909,572.884;
FlySmooth=1456.136,1623.849,572.884;
FlySmooth=1463.047,1616.692,572.884;
FlySmooth=1469.913,1609.583,572.884;
FlySmooth=1476.868,1602.373,573.069;
FlySmooth=1477.265,1594.669,572.872;
FlySmooth=1473.422,1594.99,572.872;
FlySmooth=1474.62,1595.003,572.872;

#DO=30000;
Command=/select %Var[Lyceum Teleport Statue];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#EXECUTE=ResetDialogPosition;
#DO=30000;
Mouse=138,217;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;
_IFFrameVisibleByName=airline_service_dialog;
Mouse=194,322;
Delay=650;
#ENDIF
_IFFrameVisible=%ConfirmFrameID;
Mouse=448,342;
Delay=650;
#ENDIF

#DO=300000;
Delay=500;
#UNTIL=%Position,1362.94/1481.37/569.04;

#IF=%Position,1362.94/1481.37/569.04;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 1 (10 to 20) - Couldn't Teleport at %Var[Lyceum Teleport Statue];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=1362.942,1485.727,569.039;
FlySmooth=1362.942,1492.241,569.039;
FlySmooth=1362.942,1498.747,569.076;
FlySmooth=1363.277,1505.518,569.145;
FlySmooth=1363.867,1511.996,569.169;
FlySmooth=1364.52,1518.741,569.155;
FlySmooth=1365.173,1525.505,569.11;
FlySmooth=1365.764,1531.988,569.038;
FlySmooth=1366.154,1538.768,569.038;
FlySmooth=1366.31,1542.032,569.038;
FlySmooth=1366.31,1542.032,569.038;

#DO=30000;
Command=/select %Var[Cloister of Kaisinel Teleport Statue];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=QuestSelect60100;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;
#DO=30000;
Delay=500;
#UNTIL=%Position,2149.00/1575.00/1205.48;

#IF=%Position,2149.00/1575.00/1205.48;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 2 (10 to 20) - Couldn't Teleport at %Var[Cloister of Kaisinel Teleport Statue];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=2176.85,1590.28,1206.11;
FlySmooth=2176.85,1590.28,1206.11;

#DO=30000;
Command=/select %Var[Eremitia];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=60000;
DialogClick=;
Delay=650;
DialogScroll=1;
#EXECUTE=ResetDialogPosition;
Delay=650;
Mouse=110,301;
Delay=650;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window

_IFInventoryContains=160020000,5;
#ELSE
#DO=30000;
Command=/select %Var[Eremitia];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=60000;
DialogClick=;
Delay=650;
DialogScroll=1;
#EXECUTE=ResetDialogPosition;
Delay=650;
Mouse=110,301;
Delay=650;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;
MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window
#ENDIF

#DO=30000;
Command=/select %Var[Eremitia];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=60000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;
#DO=30000;
Delay=500;
#UNTIL=%Position,483.00/497.00/499.60;

#IF=%Position,483.00/497.00/499.60;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 3 (10 to 20) - Couldn't Finish Eremitia Quest;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=498.12,499.36,499.72;
FlySmooth=498.12,499.36,499.72;

#DO=30000;
Command=/select %Var[Kaisinel];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=60000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;
#DO=30000;
Delay=500;
#UNTIL=%Position,1329.00/1512.00/569.09;

#IF=%Position,1329.00/1512.00/569.09;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 4 (10 to 20) - Couldn't Finish Kaisinel Quest;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=1332.04,1512.00,569.04;
FlySmooth=1332.04,1512.00,569.04;

#DO=30000;
Command=/select %Var[Polyidus];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#EXECUTE=ResetDialogPosition;
#DO=60000;
Mouse=126,265;
Delay=650;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=30000;
Command=/select %Var[Polyidus];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=60000;
Mouse=141,235;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[airline_service_dialog],0x28,BYTE,=175;
#DO=50000;
Mouse=157,221;
Delay=1000;
_UNTILMemPtrRead%AddrFrameID[%ConfirmFrameID],0x28,BYTE,=142;
Delay=500;
Mouse=446,342;
#DO=30000;
Delay=500;
#UNTIL=%Position,2542.23/339.28/411.90;

#IF=%Position,2542.23/339.28/411.90;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 5 (10 to 20) - Couldn't Teleport With Polyidus to Heiron;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=2529.43,345.61,411.50;
FlySmooth=2517.75,328.51,414.93;
FlySmooth=2495.10,314.04,414.93;
FlySmooth=2484.18,326.87,414.93;

#DO=30000;
Command=/select %Var[Royer 2];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=60000;
DialogClick=;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window

#DO=30000;
Command=/select %Var[Royer 2];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=60000;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=2481.28,323.043,414.933;
FlySmooth=2474.96,311.29,414.952;
FlySmooth=2469.808,299.113,418.662;
FlySmooth=2464.464,286.915,421.181;
FlySmooth=2460.309,274.442,421.448;
FlySmooth=2456.209,262.115,421.492;
FlySmooth=2451.876,249.354,421.492;
FlySmooth=2449.658,242.864,421.492;

#DO=30000;
Command=/select %Var[Sofne];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=60000;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=2451.838,248.493,421.492;
FlySmooth=2455.919,261.078,421.492;
FlySmooth=2459.784,273.805,421.448;
FlySmooth=2463.924,286.221,421.181;
FlySmooth=2469.777,298.33,419.08;
FlySmooth=2475.397,310.233,415.41;
FlySmooth=2481.151,322.372,414.933;
FlySmooth=2482.956,326.056,414.933;

#DO=30000;
Command=/select %Var[Royer 2];
Delay=55;
Command=/attack;
Delay=1500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=60000;
DialogClick=;
Delay=650;
Mouse=127,298;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=2488.279,319.62,414.933;
FlySmooth=2495.007,312.918,414.933;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window

#DO=30000;
Command=/select %Var[Nekentos];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=2490.445,313.843,414.933;
FlySmooth=2490.076,313.983,414.933;
FlySmooth=2484.573,316.412,414.933;
FlySmooth=2479.838,318.51,414.933;
FlySmooth=2477.915,319.52,414.933;

#DO=210000;
#EXECUTE=HeironFarmspot1;
_IFQuestAtStep=61622,2;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;

FlySmooth=2492.775,315.366,414.933;
FlySmooth=2480.013,318.272,414.933;
FlySmooth=2466.931,320.157,414.933;
FlySmooth=2455.155,315.06,415.408;
FlySmooth=2451.393,311.526,415.668;

#DO=30000;
Command=/select %Var[Nargis];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=2455.38,313.17,415.199;
FlySmooth=2467.928,317.893,414.933;
FlySmooth=2479.392,324.415,414.933;
FlySmooth=2482.819,326.676,414.933;

#DO=30000;
Command=/select %Var[Royer 2];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=2474.782,327.002,414.933;
FlySmooth=2461.428,327.725,414.933;
FlySmooth=2448.661,326.181,415.668;

#DO=30000;
Command=/select %Var[Loktania];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=2454.226,329.292,414.933;
FlySmooth=2465.896,329.508,414.933;
FlySmooth=2471.48,340.983,413.989;
FlySmooth=2475.774,353.413,411.375;
FlySmooth=2486.967,360.058,411.25;
FlySmooth=2499.284,365.201,411.25;
FlySmooth=2511.422,370.306,411.25;
FlySmooth=2523.536,375.599,411.375;
FlySmooth=2535.631,380.889,417.942;
FlySmooth=2547.714,386.946,417.842;
FlySmooth=2559.353,393.103,417.842;
FlySmooth=2570.976,399.374,417.842;
FlySmooth=2582.844,405.69,412.963;
FlySmooth=2594.509,411.855,408.25;
FlySmooth=2606.21,417.945,407.862;
FlySmooth=2610.208,420.169,407.487;

_ACIgnoreAtDistance=35;

_ACMob_Looting=False;

#DO=3600000;
#EXECUTE=HeironFarmspot2Ettins;
_IFQuestAtStep=61623,1;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;

FlySmooth=2602.475,416.037,408.095;
FlySmooth=2590.548,410.033,408.461;
FlySmooth=2578.646,404.214,415.21;
FlySmooth=2566.601,398.17,417.842;
FlySmooth=2554.757,392.229,417.842;
FlySmooth=2542.718,386.463,417.842;
FlySmooth=2530.868,380.323,415.578;
FlySmooth=2519.208,374.163,411.375;
FlySmooth=2507.548,368.082,411.25;
FlySmooth=2495.871,361.999,411.133;
FlySmooth=2484.075,355.877,411.375;
FlySmooth=2473.585,347.882,411.789;
FlySmooth=2468.782,335.637,414.933;
FlySmooth=2460.393,326.752,414.933;
FlySmooth=2448.555,325.972,415.668;

#DO=30000;
Command=/select %Var[Loktania];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=2452.854,325.98,415.299;
FlySmooth=2466.039,326.659,414.933;
FlySmooth=2478.676,322.781,414.933;
FlySmooth=2491.415,319.178,414.933;
FlySmooth=2503.805,315.172,415.029;
FlySmooth=2514.177,322.825,414.934;
FlySmooth=2522.837,333.002,414.934;
FlySmooth=2530.761,343.655,411.5;
FlySmooth=2542.201,348.105,411.5;
FlySmooth=2545.067,342.278,411.892;

#DO=30000;
Command=/select %Var[Amene];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
Mouse=130,220;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=30000;
Command=/select %Var[Amene];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
Mouse=143,189;
Delay=600;
_IFFrameVisibleByName=airline_service_dialog;
Mouse=110,245;
Delay=600;
#ENDIF
Delay=500;
_IFFrameVisible=%ConfirmFrameID;
Mouse=448,346;
Delay=600;
#ENDIF
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=360000;
Delay=500;
#UNTIL=%Position,1423.80/1334.40/174.90;

#IF=%Position,1423.80/1334.40/174.90;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 6 (10 to 20) - Couldn't Transport With Amene to Heiron Laboratory;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=1426.988,1335.012,174.75;
FlySmooth=1429.327,1335.235,174.75;
FlySmooth=1435.359,1333.618,174.75;
FlySmooth=1442.005,1332.853,174.928;
FlySmooth=1445.306,1334.053,175.21;
FlySmooth=1445.032,1337.336,175.314;
FlySmooth=1444.074,1343.79,174.856;
FlySmooth=1442.743,1350.388,174.845;
FlySmooth=1442.221,1353.064,174.845;
FlySmooth=1444.659,1356.786,174.845;
FlySmooth=1446.142,1359.753,174.84;
FlySmooth=1445.888,1361.897,175.078;
FlySmooth=1444.158,1363.284,175.649;
FlySmooth=1442.339,1364.189,176.025;
FlySmooth=1436.919,1363.39,177.68;
FlySmooth=1435.297,1358.566,178.752;
FlySmooth=1437.568,1353.565,180.03;
FlySmooth=1443.593,1353.935,180.495;
FlySmooth=1446.361,1358.728,180.502;
FlySmooth=1446.28,1358.309,180.501;

#DO=30000;
Command=/select %Var[Aphesius];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window

#DO=30000;
Command=/select %Var[Aphesius];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=1446.28,1358.309,180.501;
FlySmooth=1445.096,1354.582,180.496;
FlySmooth=1441.682,1352.992,180.495;
FlySmooth=1435.614,1354.416,179.633;
FlySmooth=1434.622,1360.105,178.556;
FlySmooth=1438.194,1364.175,177.156;
FlySmooth=1444.031,1363.565,175.702;
FlySmooth=1446.427,1358.457,174.842;
FlySmooth=1445.674,1357.066,174.845;
FlySmooth=1444.114,1355.673,174.845;
FlySmooth=1442.604,1353.326,174.845;
FlySmooth=1441.837,1352.22,174.845;
FlySmooth=1442.411,1350.023,174.845;
FlySmooth=1443.812,1344.976,174.847;
FlySmooth=1445.636,1338.656,175.17;
FlySmooth=1447.472,1333.701,175.139;
FlySmooth=1451.065,1334.325,174.8;
FlySmooth=1454.95,1339.743,174.75;
FlySmooth=1457.944,1345.665,174.754;
FlySmooth=1458.608,1352.064,174.792;
FlySmooth=1456.665,1358.419,174.985;
FlySmooth=1454.192,1364.166,175.113;
FlySmooth=1449.744,1369.18,174.75;
FlySmooth=1444.215,1372.982,174.75;
FlySmooth=1438.418,1376.29,175.216;
FlySmooth=1436.957,1377.168,175.258;

#DO=30000;
Command=/select %Var[Terentius];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=1436.957,1377.168,175.258;
FlySmooth=1440.092,1372.476,174.78;
FlySmooth=1445.96,1369.33,174.75;
FlySmooth=1451.235,1365.375,174.789;
FlySmooth=1454.631,1359.778,175.111;
FlySmooth=1455.759,1353.261,174.875;
FlySmooth=1455.629,1346.501,174.867;
FlySmooth=1453.245,1340.281,174.809;
FlySmooth=1450.299,1336.212,174.976;
FlySmooth=1447.317,1336.322,175.293;
FlySmooth=1446.215,1338.111,175.341;
FlySmooth=1445.216,1341.471,174.856;
FlySmooth=1444.118,1345.472,174.847;
FlySmooth=1443.166,1348.946,174.846;
FlySmooth=1442.533,1351.399,174.845;
FlySmooth=1442.604,1353.784,174.845;
FlySmooth=1444.691,1356.474,174.845;
FlySmooth=1446.558,1359.492,174.84;
FlySmooth=1445.905,1363.05,175.238;
FlySmooth=1441.864,1364.934,176.172;
FlySmooth=1437.314,1364.252,177.441;
FlySmooth=1434.788,1360.973,178.43;
FlySmooth=1435.66,1355.35,179.418;
FlySmooth=1440.446,1353.218,180.499;
FlySmooth=1444.586,1354.359,180.495;
FlySmooth=1446.263,1357.956,180.5;

#DO=30000;
Command=/select %Var[Aphesius];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=1446.283,1358.282,180.501;
FlySmooth=1444.535,1354.636,180.496;
FlySmooth=1440.259,1352.037,180.5;
FlySmooth=1436.375,1354.337,179.813;
FlySmooth=1434.129,1359.512,178.629;
FlySmooth=1437.903,1364.269,177.235;
FlySmooth=1442.801,1364.178,175.951;
FlySmooth=1445.251,1361.803,175.089;
FlySmooth=1446.749,1359.057,174.841;
FlySmooth=1446.275,1357.304,174.844;
FlySmooth=1444.245,1355.431,174.845;
FlySmooth=1441.771,1353.129,174.845;
FlySmooth=1442.166,1351.003,174.845;
FlySmooth=1443.077,1347.656,174.846;
FlySmooth=1444.08,1344.002,174.847;
FlySmooth=1445.433,1339.07,175.041;
FlySmooth=1447.008,1333.331,175.145;
FlySmooth=1448.393,1328.231,174.64;
FlySmooth=1447.669,1329.006,174.688;
FlySmooth=1449.863,1319.377,173.728;
FlySmooth=1452.262,1309.738,171.168;
FlySmooth=1455.247,1300.193,169.161;
FlySmooth=1458.746,1290.888,168.111;
FlySmooth=1461.795,1281.439,167.603;
FlySmooth=1466.076,1272.485,166.686;
FlySmooth=1471.589,1264.249,165.083;
FlySmooth=1477.655,1256.228,163.779;
FlySmooth=1483.646,1248.307,162.841;
FlySmooth=1488.698,1239.813,162.585;
FlySmooth=1490.311,1230.018,160.727;
FlySmooth=1488.715,1220.209,157.089;
FlySmooth=1486.242,1210.558,154.28;
FlySmooth=1483.206,1201.104,153.569;
FlySmooth=1476.794,1193.522,151.544;
FlySmooth=1470.5,1185.853,149.366;
FlySmooth=1462.315,1182.295,147.539;
FlySmooth=1451.828,1183.286,145.159;
FlySmooth=1442.2,1181.489,142.524;
FlySmooth=1437.301,1172.962,140.684;
FlySmooth=1434.357,1163.431,141.281;
FlySmooth=1431.465,1153.924,141.246;
FlySmooth=1425.7,1145.943,139.963;
FlySmooth=1418.509,1139.53,138.471;

_ACMob_Looting=False;

_ACIgnoreAtDistance=35;

#DO=3600000;
#EXECUTE=HeironFarmspot3PoyaJungle;
_IFQuestAtStep=61602,1;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;

_SetVar=MTDestination,46; // Teleport ID Senea s campsite

#DO=100000;
#EXECUTE=MapTeleport; // Starts Teleport
Delay=15000;
#UNTIL=%Position,970/687/135.414;

#IF=%Position,970/687/135.414;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 7 (10 to 20) - Couldn't Teleport to Senea Campsite;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=973.216,688.36,135.25;
FlySmooth=980.892,693.526,135.25;

#DO=30000;
Command=/select %Var[Senea];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
Mouse=119,346;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=30000;
Command=/select %Var[Scouting Royer];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=30000;
Command=/select %Var[Scouting Royer];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

Delay=5000;

#DO=120000;
FlySmooth=980.892,693.526,135.25;
Delay=500;
SendKey=0x49;
Delay=1000;
Command=/Use RMa-25 Experiment Plan;
Delay=1000;
MemPtrWrite=%AddrFrameName[read_item_dialog],0x28,142,BYTE; //Hide Experiment Plan
Delay=1000;
SendKey=0x1B;
Delay=200;
_IFQuestAtStep=61603,3;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;

Delay=650;

#DO=30000;
Command=/select %Var[Scouting Royer];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#EXECUTE=CombatSort;

FlySmooth=980.006,693.596,135.25;
FlySmooth=975.529,698.379,135.25;
FlySmooth=971.214,703.277,135.25;
FlySmooth=967.055,708.681,135.25;
FlySmooth=963.057,713.89,135.25;
FlySmooth=959.16,719.159,135.25;
FlySmooth=955.657,724.697,134.786;
FlySmooth=952.2,730.558,134.262;
FlySmooth=948.943,736.265,133.983;
FlySmooth=945.201,741.946,133.825;
FlySmooth=939.154,743.658,133.269;
FlySmooth=933.907,739.897,132.475;
FlySmooth=928.505,737.405,132.088;
FlySmooth=923.833,733.338,131.844;
FlySmooth=920.061,727.993,130.881;
FlySmooth=916.416,722.935,129.669;
FlySmooth=912.624,718.102,128.175;
FlySmooth=908.035,714.53,126.854;
FlySmooth=902.037,716.888,125.995;
FlySmooth=896.465,720.344,124.558;
FlySmooth=893.743,721.625,124.273;

_ACMob_Looting=True;
_ACMob_Blacklist=---,---;

#DO=180000;
MemWrite=%AddrCamY,17,FLOAT;
#EXECUTE=LepharistFarmspot1;
_IFQuestInventoryContains=182216579,1;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;

FlySmooth=891.645,718.321,124.815;
FlySmooth=889.898,713.15,124.553;
FlySmooth=887.852,706.919,123.307;
FlySmooth=887.654,700.197,123.125;
FlySmooth=889.562,693.994,123.571;
FlySmooth=893.965,688.827,124.55;
FlySmooth=899.095,684.748,124.209;
FlySmooth=904.465,680.548,124.313;
FlySmooth=909.268,676.154,123.897;
FlySmooth=911.353,669.803,122.488;
FlySmooth=910.367,663.452,121.989;
FlySmooth=906.844,657.649,121.009;
FlySmooth=902.955,652.385,119.918;
FlySmooth=898.554,647.197,119.009;
FlySmooth=893.646,642.842,118.197;
FlySmooth=888.729,638.534,117.783;
FlySmooth=883.82,634.233,117.651;
FlySmooth=878.584,629.489,118.184;
FlySmooth=874.294,624.573,117.661;
FlySmooth=870.344,619.337,116.459;
FlySmooth=866.688,613.672,116.125;
FlySmooth=862.933,608.229,115.823;
FlySmooth=858.246,603.741,115.624;
FlySmooth=852.154,600.724,114.07;
FlySmooth=845.857,598.596,112.469;
FlySmooth=839.648,596.502,111.813;
FlySmooth=833.347,594.624,111.994;
FlySmooth=826.994,593.074,111.205;
FlySmooth=820.289,591.929,108.456;
FlySmooth=813.799,591.084,107.112;
FlySmooth=807.367,589.884,106.757;
FlySmooth=800.99,587.397,106.75;
FlySmooth=795.513,583.422,106.689;
FlySmooth=791.334,578.397,106.417;
FlySmooth=787.441,573.148,106.82;
FlySmooth=783.823,567.364,107.625;
FlySmooth=779.814,562.215,107.638;
_ACDetectIfAttacked=;
FlySmooth=779.252,561.608,107.6;
FlySmooth=779.252,561.608,107.6;
FlySmooth=776.644,558.787,107.424;
_ACDetectIfAttacked=;
FlySmooth=774.435,553.391,106.902;
FlySmooth=771.34,548.41,106.625;
FlySmooth=765.47,546.102,106.756;
FlySmooth=758.984,545.43,107.341;
FlySmooth=752.197,545.065,108.475;
FlySmooth=745.667,545.174,109;
_ACDetectIfAttacked=;
FlySmooth=738.859,545.387,111.289;
FlySmooth=732.331,545.967,114.52;
FlySmooth=725.807,547.751,114.746;
FlySmooth=720.485,551.477,114.752;
FlySmooth=715.969,556.174,114.75;
FlySmooth=711.709,561.357,115.42;
FlySmooth=707.015,565.49,115.468;
_ACDetectIfAttacked=;
FlySmooth=702.378,570.128,115.5;
FlySmooth=697.171,574.226,115.764;
FlySmooth=691.966,578.165,115.875;
FlySmooth=686.833,582.637,116.278;
FlySmooth=685.053,588.891,118.402;
FlySmooth=683.717,595.284,119.455;
FlySmooth=682.914,602.051,119.628;
FlySmooth=682.15,608.808,120.11;
FlySmooth=683.027,615.271,121.159;
FlySmooth=684.233,621.713,122.1;
FlySmooth=687.341,627.718,123.216;
FlySmooth=693.112,630.647,124.624;
FlySmooth=699.575,630.977,125.322;
_ACDetectIfAttacked=;
FlySmooth=706.09,629.281,125.75;
FlySmooth=711.982,626.394,125.75;
FlySmooth=716.604,624.063,125.75;
_ACDetectIfAttacked=;

#DO=30000;
Command=/select %Var[Riley];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
Mouse=117,336;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window

#DO=30000;
Command=/select %Var[Riley];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=716.354,623.997,125.75;
FlySmooth=710.302,626.586,125.75;
FlySmooth=703.998,628.661,125.625;
FlySmooth=697.629,630.205,125.102;
FlySmooth=691.347,632.479,124.408;
FlySmooth=685.289,635.281,123.536;
FlySmooth=679.531,638.544,124.175;
FlySmooth=674.043,642.494,125.004;
FlySmooth=668.837,646.529,125.474;
FlySmooth=663.773,650.867,126.427;
_ACDetectIfAttacked=;
FlySmooth=658.914,655.438,126.897;
FlySmooth=654.263,660.197,129.865;
FlySmooth=649.643,665.101,131.134;
FlySmooth=645.094,669.928,131.134;
FlySmooth=640.58,674.78,131;
FlySmooth=636.418,679.856,131;
FlySmooth=630.644,680.993,130.665;
FlySmooth=624.985,683.194,129.924;
FlySmooth=619.786,686.183,129.511;
_ACDetectIfAttacked=;
FlySmooth=614.807,689.444,129.915;
FlySmooth=613.101,695.613,130.351;
FlySmooth=611.779,702.09,130.764;
FlySmooth=610.429,708.697,131.098;
FlySmooth=609.109,715.164,131.086;
FlySmooth=607.793,721.606,132.101;
FlySmooth=606.62,728.221,132.98;
FlySmooth=606.354,734.795,133.666;
FlySmooth=606.371,741.477,134.023;
FlySmooth=606.519,748.085,134.288;
FlySmooth=606.754,754.764,134.797;
FlySmooth=606.989,761.439,134.785;
FlySmooth=607.22,767.992,134.625;
FlySmooth=607.282,774.762,134.548;
FlySmooth=605.279,781.034,134.67;
FlySmooth=601.001,786.353,135.062;
_ACDetectIfAttacked=;
FlySmooth=596.03,790.773,135.203;
FlySmooth=591.284,795.436,135.25;
FlySmooth=586.817,800.364,135.375;
FlySmooth=582.433,805.355,135.375;
FlySmooth=578.072,810.329,135.375;
FlySmooth=573.678,815.341,135.375;
FlySmooth=569.313,820.319,135.625;
FlySmooth=564.945,825.3,135.625;
FlySmooth=560.568,830.292,135.804;
FlySmooth=556.211,835.261,135.987;
FlySmooth=551.755,839.894,136.529;
_ACDetectIfAttacked=;
FlySmooth=547.543,844.094,136.71;
FlySmooth=543.846,848.718,136.25;
FlySmooth=542.123,854.1,136.119;
FlySmooth=544.314,860.322,135.314;
FlySmooth=546.974,866.477,134.373;
FlySmooth=549.803,872.513,133.747;
FlySmooth=552.709,878.433,132.971;
FlySmooth=555.907,884.48,132.339;
FlySmooth=559.254,890.142,131.991;
_ACDetectIfAttacked=;
FlySmooth=562.885,895.669,131.785;
FlySmooth=566.707,901.137,132.284;
FlySmooth=571.284,905.94,132.702;
FlySmooth=576.215,910.388,133.149;
FlySmooth=581.693,913.999,133.5;
_ACDetectIfAttacked=;
FlySmooth=587.65,916.543,133.955;
FlySmooth=592.795,919.238,134.937;
FlySmooth=593.572,925.472,135.723;
FlySmooth=593.831,932.157,135.957;
FlySmooth=594.449,938.812,136.674;
_ACDetectIfAttacked=;
FlySmooth=592.458,945.108,135.601;
_ACDetectIfAttacked=;
FlySmooth=591.202,947.843,135.49;
_ACDetectIfAttacked=;

#DO=30000;
Command=/select %Var[Riala];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=591.166,947.896,135.494;
FlySmooth=589.207,949.47,135.5;
FlySmooth=589.106,956.179,135.166;
FlySmooth=589.047,962.847,135.164;
FlySmooth=589.026,969.446,135.164;
FlySmooth=589.004,976.193,135.164;
FlySmooth=589.155,982.496,135.164;
FlySmooth=589.134,989.103,135.166;
FlySmooth=589.112,995.761,135.166;
FlySmooth=589.091,1002.44,135.166;
FlySmooth=589.067,1005.962,134.987;
_ACDetectIfAttacked=;

#DO=360000;
#EXECUTE=LepharistFarmspot2;
_IFQuestAtStep=61604,2;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;

_ACMob_Blacklist=---,---;

FlySmooth=596.986,1008.774,135.116;
FlySmooth=594.035,1005.751,135.441;
MoveTo=593.495,1005.357,138.496,False,False;
MoveTo=592.981,1005,139.549,True,False;
FlySmooth=597.777,1025.149,139.549;
Delay=5;
FlySmooth=597.777,1025.149,139.549;
Delay=5;
FlySmooth=575.335,1039.266,139.549;
Delay=5;
FlySmooth=575.335,1039.266,139.549;
Delay=5;
FlySmooth=533.137,1040.518,139.549;
Delay=5;
FlySmooth=533.137,1040.518,139.549;
Delay=5;
FlySmooth=515.682,1041.051,139.549;
Delay=5;
FlySmooth=515.682,1041.051,139.549;
MoveTo=515.682,1041.051,135.549,True,False;
MoveTo=515.682,1041.051,131.549,True,False;
MoveTo=515.682,1041.051,128.146,True,False;
FlySmooth=503.363,1041.059,128.146;
Delay=5;
FlySmooth=490.521,1044.78,128.146;
MoveTo=490.521,1044.78,128.9,True,False;
FlySmooth=479.119,1049.028,128.9;
Delay=5;
FlySmooth=459.935,1051.158,128.9;
_SetVar=Finished,0;
#DO=40000;
Delay=500;
_IFDebuffAlive=16674;
_SetVar=Finished,0;
#ELSE
_SetVar=Finished,1;
#ENDIF
#UNTIL=%Var[Finished],=1;
#DO=60000;
Command=/select Door to the Pretor Experiment Lab;
Delay=125;
Command=/attack;
Delay=1000;
DialogClick=;
Delay=600;
DialogClick=;
#2DO=10000;
Delay=500;
#2UNTIL=%Position,398/718/127.404;
#UNTIL=%Position,398/718/127.404;

#IF=%Position,398/718/127.404;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 8 (10 to 20) - Couldn't use Door to the Pretor Experiment Lab;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

MoveTo=398,718,127.404,False,False;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

FlySmooth=398,718,127.404;
_ACCheckMob=;
_ACCheckMob=;
FlySmooth=393.998,718.568,127.404;
_ACCheckMob=;
_ACCheckMob=;
FlySmooth=387.41,719.558,127.404;
_ACCheckMob=;
_ACCheckMob=;
_ACDetectIfAttacked=;
_ACDetectIfAttacked=;
FlySmooth=381.032,721.292,127.404;
_ACDetectIfAttacked=;
_ACDetectIfAttacked=;
FlySmooth=375.128,724.287,127.404;
_ACDetectIfAttacked=;
_ACDetectIfAttacked=;
FlySmooth=370.467,727.936,127.567;
_ACDetectIfAttacked=;
_ACDetectIfAttacked=;
FlySmooth=369.629,728.278,127.567;
_ACDetectIfAttacked=;
_ACDetectIfAttacked=;

#DO=10000;
_ACDetectIfAttacked=;
#UNTIL=1,=2;

#DO=60000;
_ACDetectIfAttacked=;
Delay=%Var[WaitAfterDetectOrCheckMob];
SendKey=0x77;
Delay=1000;
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[Uriel];

#DO=30000;
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=1000;
DialogClick=;
Delay=2000;
SendKey=0x1B;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=369.004,728.257,127.567;
FlySmooth=369.004,728.257,127.567;
_ACDetectIfAttacked=;
FlySmooth=371.983,725.104,127.404;
_ACDetectIfAttacked=;
FlySmooth=377.016,720.852,127.404;
FlySmooth=379.959,714.694,127.404;
_ACDetectIfAttacked=;
FlySmooth=382.08,695.944,127.54;
FlySmooth=382.288,687.944,127.66;
_ACDetectIfAttacked=;
FlySmooth=382.565,679.946,131.604;
FlySmooth=383.437,672.098,135.825;
_ACDetectIfAttacked=;
FlySmooth=385.342,664.446,139.94;
FlySmooth=386.727,656.428,140.463;
_ACDetectIfAttacked=;
_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;
FlySmooth=386.48,648.731,140.25;
FlySmooth=382.441,642.961,140.412;
_ACDetectIfAttacked=;
FlySmooth=376.013,637.854,141.766;
FlySmooth=370.018,632.614,143.208;
_ACDetectIfAttacked=;
FlySmooth=363.208,628.53,144.632;
FlySmooth=356.474,624.398,146.807;
_ACDetectIfAttacked=;
_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;
FlySmooth=349.478,620.643,150.218;
FlySmooth=342.046,617.767,154.789;
_ACDetectIfAttacked=;
FlySmooth=334.548,614.89,156.73;
FlySmooth=326.835,612.919,157.463;
_ACDetectIfAttacked=;
FlySmooth=319.178,610.702,157.97;
FlySmooth=312.574,606.395,158.091;
_ACDetectIfAttacked=;
_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;
FlySmooth=310.93,598.77,158.194;
FlySmooth=310,590.912,158.125;
_ACDetectIfAttacked=;
FlySmooth=308.678,583.038,158.125;
FlySmooth=310.135,575.188,158.152;
_ACDetectIfAttacked=;
FlySmooth=311.794,567.438,158.152;
FlySmooth=309.313,560.34,158.272;
_ACDetectIfAttacked=;
_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;
FlySmooth=303.524,557.651,159.319;
FlySmooth=296.997,553.336,159.616;
_ACDetectIfAttacked=;
FlySmooth=290.248,550.67,158.56;
FlySmooth=283.988,546.386,157.75;
_ACDetectIfAttacked=;
FlySmooth=278.704,540.371,158.188;
FlySmooth=274.44,534.483,158.61;
_ACDetectIfAttacked=;
_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;
FlySmooth=270.383,527.906,157.857;
FlySmooth=266.166,521.131,157.918;
_ACDetectIfAttacked=;
FlySmooth=261.467,514.707,157.75;
FlySmooth=256.386,508.663,157.75;
_ACDetectIfAttacked=;
FlySmooth=250.828,505.105,157.75;
_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

#DO=30000;
_ACDetectIfAttacked=;
Command=/select %Var[Punctual Royer];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#EXECUTE=RemoveTarget;
FlySmooth=251.171,506.573,157.75;
FlySmooth=250.335,513.079,157.75;
FlySmooth=250.355,519.059,157.75;
FlySmooth=248.241,525.155,158.026;
FlySmooth=247.988,525.645,158.061;
_ACCheckMob=;
FlySmooth=247.988,525.645,158.061;
FlySmooth=245.164,530.964,158.42;
_ACDetectIfAttacked=;
FlySmooth=241.33,534.866,158.639;
FlySmooth=238.113,534.365,158.654;

#DO=60000;
_ACDetectIfAttacked=;
Command=/select Aetherogenetics Lab Entrance;
Delay=125;
Command=/attack;
Delay=7000;
DialogClick=;
Delay=600;
#UNTIL=%Position,381.037/230.943/156.248;

#IF=%Position,381.037/230.943/156.248;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 9 (10 to 20) - Couldn't teleport inside AetherogeneticsLab;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

Delay=5000;
#EXECUTE=RemoveTarget;

#EXECUTE=AetherogeneticsLab;

_SetVar=MpSitting,50;
_SetVar=HpSitting,90;
#EXECUTE=RegenerateFunc;

_SetVar=InstantReport,61702;
#EXECUTE=BlueQuestInstantReport;

Delay=1000;

_SetVar=InstantReport,61701;
#EXECUTE=BlueQuestInstantReport;

FlySmooth=416.249,919.883,122.5;
FlySmooth=417.218,916.483,122.5;
FlySmooth=418.547,912.311,122.5;
FlySmooth=416.591,911.218,122.5;

#DO=30000;
Command=/select %Var[Battling Royer];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=30000;
Command=/select %Var[Battling Royer];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=128,325;
Mouse=128,325;
Delay=600;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window

#DO=30000;
Command=/select %Var[Battling Royer];
Delay=55;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
#EXECUTE=ResetDialogPosition;
Mouse=117,327;
Mouse=117,327;
Mouse=121,288;
Mouse=121,288;
Delay=600;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

_IFMemRead=%AddrMap,DWORD,=110010000; // If is already in Sanctum
_IFMemPtrRead=%PlayerBase,%OffsetPosX,FLOAT,1328-1374;
_IFMemPtrRead=%PlayerBase,%OffsetPosY,FLOAT,1490-1536;
_IFMemPtrRead=%PlayerBase,%OffsetPosZ,FLOAT,563-572; // Nearby Obelisk
#ELSE
#DO=30000;
UseID=243; // Recall
Delay=9000;
#ENDIF

_Calc[CreatedCharacters]=%Var[CreatedCharacters]+1;
SetScriptTitle=%AionTitle - (%Var[CreatedCharacters]/%Var[DeletedCharacters]);
_SetVar=MSG,has successfully finished leveling/nCreated Characters: %Var[CreatedCharacters]/nStucked Characters: %Var[DeletedCharacters];
#EXECUTE=DiscordPost;

#IF=%Var[Loop],=0;
#EXECUTE=End;
#ENDIF

Delay=3000;

end_Main;



start_BindToObelisk;

#IF=%Var[Luna],=0;
FlySmooth=1324,1512,567.875;
FlySmooth=1329.443,1511.9,569.076;
FlySmooth=1335.658,1511.958,569.039;
FlySmooth=1341.63,1512.017,569.039;
FlySmooth=1347.605,1512.005,569.039;
FlySmooth=1353.841,1511.927,569.039;
FlySmooth=1359.933,1511.773,569.12;
FlySmooth=1361.173,1511.744,569.136;
#ENDIF

FlySmooth=1366.503,1511.741,569.15;
FlySmooth=1366.503,1511.741,569.15;
Command=/select Obelisk;
Delay=125;
Command=/attack;
Delay=3000;
MemPtrWrite=%AddrFrameID[%ConfirmFrameID],0x6C,0,FLOAT;
MemPtrWrite=%AddrFrameID[%ConfirmFrameID],0x74,0,FLOAT;
Delay=250;
Mouse=162,86; // OK
Delay=500;

end_BindToObelisk;



start_AcceptLuna;

FlySmooth=1324,1512,567.875;
FlySmooth=1329.443,1511.9,569.076;
FlySmooth=1335.658,1511.958,569.039;
FlySmooth=1341.63,1512.017,569.039;
FlySmooth=1347.605,1512.005,569.039;
FlySmooth=1353.841,1511.927,569.039;
FlySmooth=1359.933,1511.773,569.12;
FlySmooth=1361.173,1511.744,569.136;

#DO=60000;
Command=/select %Var[Eli];
Delay=125;
Command=/attack;
Delay=750;
UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
DialogClick=QuestSelect80868;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=60000;
Command=/select %Var[Eli];
Delay=125;
Command=/attack;
Delay=750;
UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
DialogClick=QuestSelect80875;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

#DO=60000;
Command=/select %Var[Eli];
Delay=125;
Command=/attack;
Delay=750;
UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
DialogClick=QuestSelect80876;
Delay=650;
#EXECUTE=ResetDialogPosition;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Delay=650;
UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

end_AcceptLuna;




start_ModifiedDialogClick;

MemWrite=0xA0BFD4,0x9090909090,BYTE[5];
MemPtrWrite=%AddrFrameName[dlg_dialog],0x518/0x2B0/0x0/0x0/0x10/0x74,0,FLOAT;
MemPtrWrite=%AddrFrameName[dlg_dialog],0x518/0x2B0/0x0/0x0/0x10/0x84,10,FLOAT;
MemPtrWrite=%AddrFrameName[dlg_dialog],0x518/0x2B0/0x0/0x0/0x10/0xA4,10,FLOAT;
Delay=15;
Mouse=123,123;
Delay=15;
MemWrite=0xA0BFD4,0x410F114668,BYTE[5];
Delay=1500;

end_ModifiedDialogClick;

start_RemoveTarget;

_IFMemRead=%AddrTargetID,WORD,>0;
#DO=2000;
SendKey=0x1B;
Delay=200;
_UNTILMemRead=%AddrTargetID,WORD,=0;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
#ENDIF

end_RemoveTarget;

start_ChooseClass;

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=0; <- Warrior
#IF=%Var8,=1;
DialogClick=select1;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=0; <- Warrior
#IF=%Var8,=2;
DialogClick=select2;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=3; <- Scout
#IF=%Var8,=1;
DialogClick=select1;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=3; <- Scout
#IF=%Var8,=2;
DialogClick=select2;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=6; <- Mage
#IF=%Var8,=1;
DialogClick=select1;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=6; <- Mage
#IF=%Var8,=2;
DialogClick=select2;
Delay=1200;
DialogClick=;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=9; <- Priest
#IF=%Var8,=1;
DialogClick=select1;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=9; <- Priest
#IF=%Var8,=2;
DialogClick=select2;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF


_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=12; <- Technist
#IF=%Var8,=1;
DialogClick=select1;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=12; <- Technist
#IF=%Var8,=2;
DialogClick=select2;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=15; <- Muse
#IF=%Var8,=1;
DialogClick=select1;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=15; <- Muse
#IF=%Var8,=2;
DialogClick=select2;
Delay=1200;
DialogClick=;
Delay=650;
#ENDIF

end_ChooseClass;



start_CombatFinal;

MemWrite=%AddrFreeMem0,1,BYTE;

_ACIgnoreAtDistance=5;
_ACResetPosition=False;

#3DO=90000; 1:30min

_ACDetectIfAttacked=;
Command=/select %Var[Gruesome Oris];
Delay=125;
#IF=%TargetName,%Var[Gruesome Oris];
_ACCheckMob=;
Delay=5000;
_ACDetectIfAttacked=;
Delay=2000;
_ACDetectIfAttacked=;
Delay=2000;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
MemWrite=%AddrFreeMem0,2,BYTE;
#ELSE
Command=/select %Var[Raider];
Delay=125;
_ACCheckMob=;
#ENDIF

_3UNTILMemRead=%AddrFreeMem0,BYTE,=2;

_ACResetPosition=True;
_ACIgnoreAtDistance=25;

end_CombatFinal;



start_Haramel;

UseID=160040083;

UseSpeed=400;
MoveSmooth=149,44;
FlySmooth=146.04,51.689,143.796;

Command=/select %Var[Dukaki Watchman];
Delay=125;
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[32],=%Var[Dukaki Watchman];
_MemPtrReadVar=%PlayerBase,%OffsetData/0x30,WORD,29;
_IFMemPtrRead=%AddrFrameName[target_assist_dialog],0x560,WORD,=%Var29; Target has player as target
_AutoCombat=;
#ENDIF

Command=/select %Var[Dukaki Protector];
Delay=125;
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[32],=%Var[Dukaki Protector];
_MemPtrReadVar=%PlayerBase,%OffsetData/0x30,WORD,29;
_IFMemPtrRead=%AddrFrameName[target_assist_dialog],0x560,WORD,=%Var29; Target has player as target
_AutoCombat=;
#ENDIF

_ACDetectIfAttacked=;
FlySmooth=148.952,61.062,143.796;
_ACDetectIfAttacked=;
FlySmooth=153.809,66.219,143.796;
_ACDetectIfAttacked=;
FlySmooth=157.1,75.878,143.796;
_ACDetectIfAttacked=;
FlySmooth=167.761,77.646,143.796;

#DO=4000;
_ACDetectIfAttacked=;
Delay=500;
#UNTIL=1,=2;
_ACDetectIfAttacked=;
Delay=500;

Command=/select %Var[Drudgelord Kakiti];
Delay=150;
_AutoCombat=;
Delay=3500;

_ACDetectIfAttacked=;
Delay=500;

Command=/select %Var[Drudgelord Kakiti];
Delay=150;
_IFMemPtrRead=%TargetBase,%OffsetHP,DWORD,>0;
_AutoCombat=;
Delay=3500;
#ENDIF

_IFQuestAtStep=60009,4;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 19 - Couldn't finish %Var[Quest60009];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

Command=/select %Var[Dukaki Watchman];
Delay=125;
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[32],=%Var[Dukaki Watchman];
_MemPtrReadVar=%PlayerBase,%OffsetData/0x30,WORD,29;
_IFMemPtrRead=%AddrFrameName[target_assist_dialog],0x560,WORD,=%Var29; Target has player as target
_AutoCombat=;
#ENDIF

_ACDetectIfAttacked=;
Delay=500;
_ACDetectIfAttacked=;
Delay=500;

FlySmooth=167.761,77.646,143.796;
FlySmooth=160.951,86.115,143.796;
_ACDetectIfAttacked=;
FlySmooth=160.951,86.115,143.796;
FlySmooth=155.19,92.258,143.796;
_ACDetectIfAttacked=;
FlySmooth=155.19,92.258,143.796;
FlySmooth=151.202,106.285,143.796;
_ACDetectIfAttacked=;
FlySmooth=151.202,106.285,143.796;
FlySmooth=149.5,127.524,144.246;
_ACDetectIfAttacked=;
FlySmooth=149.5,127.524,144.246;
FlySmooth=150.353,133.34,144.246;
_ACDetectIfAttacked=;
FlySmooth=150.353,133.34,144.246;
_ACDetectIfAttacked=;
FlySmooth=150.353,133.34,144.246;
FlySmooth=151.276,143.924,144.246;
_ACDetectIfAttacked=;
FlySmooth=151.276,143.924,144.246;
FlySmooth=157.71,145.881,144.135;
_ACDetectIfAttacked=;
FlySmooth=157.71,145.881,144.135;
FlySmooth=170.628,145.88,142.555;
_ACDetectIfAttacked=;
FlySmooth=170.628,145.88,142.555;
FlySmooth=182.903,145.878,141.054;
_ACDetectIfAttacked=;
FlySmooth=182.903,145.878,141.054;
FlySmooth=195.795,145.892,139.512;
_ACDetectIfAttacked=;
FlySmooth=195.795,145.892,139.512;
FlySmooth=203.103,145.961,138.647;
_ACDetectIfAttacked=;
FlySmooth=203.103,145.961,138.647;
FlySmooth=215.86,147.746,137.141;
_ACDetectIfAttacked=;
FlySmooth=215.86,147.746,137.141;
FlySmooth=223.448,152.229,137.057;
_ACDetectIfAttacked=;
FlySmooth=223.448,152.229,137.057;
FlySmooth=223.82,163.693,137.059;
_ACDetectIfAttacked=;
FlySmooth=223.82,163.693,137.059;
FlySmooth=224.236,174.526,136.959;
_ACDetectIfAttacked=;
FlySmooth=224.236,174.526,136.959;
FlySmooth=224.095,183.598,136.442;
_ACDetectIfAttacked=;
FlySmooth=224.095,183.598,136.442;
FlySmooth=223.939,193.697,137.934;
_ACDetectIfAttacked=;
FlySmooth=223.939,193.697,137.934;
FlySmooth=223.928,194.385,138.08;
_ACDetectIfAttacked=;
FlySmooth=223.928,194.385,138.08;
FlySmooth=225.693,207.19,139.82;
_ACDetectIfAttacked=;
FlySmooth=225.693,207.19,139.82;

_IFQuestAtStep=60009,5;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 20 - Couldn't finish %Var[Quest60009];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#DO=300000;
_ACDetectIfAttacked=;
#EXECUTE=SheatheWeapon;
Command=/select %Var[Tower Lift];
Delay=125;
Command=/attack;
Delay=6000;
#UNTIL=%Position,229.581/213.631/89.279;

FlySmooth=234.908,213.142,89.279;
FlySmooth=234.908,213.142,89.279;
Command=/select %Var[MuMu Mechanic];
Delay=125;
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[MuMu Mechanic];
#IF=%TargetDistance,<7;
_AutoCombat=;
#ENDIF
Delay=500;
_ACDetectIfAttacked=;

FlySmooth=253.497,213.979,88.073;
FlySmooth=259.904,213.395,88.952;
_ACDetectIfAttacked=;
FlySmooth=259.904,213.395,88.952;
FlySmooth=270.625,214.086,89.079;
FlySmooth=282.394,214.183,88.145;
FlySmooth=293.996,215.665,88.145;
FlySmooth=305.26,219.205,88.145;

Command=/select %Var[MuMu Porter];
Delay=125;
_AutoCombat=;

FlySmooth=305.26,219.205,88.145;
FlySmooth=305.26,219.205,88.145;
FlySmooth=310.79,228.617,88.145;
_ACDetectIfAttacked=;
FlySmooth=310.79,228.617,88.145;
FlySmooth=308.359,239.029,88.994;
FlySmooth=308.359,239.029,88.994;
FlySmooth=298.159,250.458,90.081;
FlySmooth=298.159,250.458,90.081;
FlySmooth=295.382,254.947,90.081;
FlySmooth=295.382,254.947,90.081;

Command=/select %Var[MuMu Fighter];
Delay=125;
_AutoCombat=;

FlySmooth=287.833,266.901,90.081;
_ACDetectIfAttacked=;
Delay=125;

#DO=3000;
Command=/select %Var[MuMu Ham the Grey];
Delay=325;
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[MuMu Ham the Grey];
_AutoCombat=;
#ENDIF
#UNTIL=1,=2;

FlySmooth=292.127,268.744,90.081;
FlySmooth=292.127,268.744,90.081;
FlySmooth=305.255,268.254,89.027;
FlySmooth=305.255,268.254,89.027;
_ACDetectIfAttacked=;

_IFQuestAtStep=60009,6;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 21 - Couldn't finish %Var[Quest60009];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=314.764,269.026,89.027;
FlySmooth=314.764,269.026,89.027;
FlySmooth=320.136,278.942,89.027;
FlySmooth=320.136,278.942,89.027;
FlySmooth=325.925,283.216,89.538;
FlySmooth=325.925,283.216,89.538;

Command=/select %Var[MuMu Fighter];
Delay=125;
_AutoCombat=;

FlySmooth=340.795,290.914,90.081;
FlySmooth=336.061,293.163,91.562;
_ACDetectIfAttacked=;

SendKey=0x1B;
Delay=15;
SendKey=0x1B;
Delay=15;
SendKey=0x1B;
Delay=15;

Command=/select %Var[MuMu Porter];
Delay=125;
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[32],=%Var[MuMu Porter];
_MemPtrReadVar=%PlayerBase,%OffsetData/0x30,WORD,29;
_IFMemPtrRead=%AddrFrameName[target_assist_dialog],0x560,WORD,=%Var29; Target has player as target
_AutoCombat=;
SendKey=0x43;
Delay=15;
SendKey=0x43;
Delay=15;
SendKey=0x43;
Delay=15;
SendKey=0x1B;
Delay=15;
#ENDIF
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[32],=%Var[MuMu Porter];
#DO=30000;
Delay=500;
#UNTIL=%TargetDistance,>20;
#ENDIF

#EXECUTE=SheatheWeapon;
MoveTo=335.918,293.308,92.459,True,False;
MoveTo=335.918,293.308,93.603,True,False;
MoveTo=335.918,293.308,94.748,True,False;

FlySmooth=351.547,296.08,94.748;
FlySmooth=351.547,296.08,94.748;
MoveTo=351.547,296.08,96,711,True,False;

FlySmooth=357.772,305.05,96;
FlySmooth=357.772,305.05,96;
FlySmooth=367.334,319.195,96;
FlySmooth=367.334,319.195,96;
FlySmooth=374.447,328.812,96;
FlySmooth=374.447,328.812,96;

MoveTo=374.447,328.812,90,True,False;

Command=/select %Var[Odella];
Delay=125;
#IF=%TargetDistance,<8;
Command=/attack;
Delay=5000;
SendKey=0x43;
Delay=25;
SendKey=0x43;
#ENDIF

Delay=1250;

Command=/select %Var[Odella];
Delay=125;
#IF=%TargetDistance,<8;
Command=/attack;
Delay=5000;
SendKey=0x43;
Delay=25;
SendKey=0x43;
#ENDIF

MoveTo=374.447,328.812,91,True,False;
Delay=450;
MoveTo=374.447,328.812,93.5,True,False;
Delay=450;
MoveTo=374.447,328.812,96,True,False;
Delay=450;

FlySmooth=366.782,327.262,96;
FlySmooth=366.782,327.262,96;
FlySmooth=350.054,324.931,96;
FlySmooth=350.054,324.931,96;
FlySmooth=337.452,321.874,96;
FlySmooth=337.452,321.874,96;

MoveTo=337.452,321.874,92,True,False;

Command=/select %Var[Odella];
Delay=125;
#IF=%TargetDistance,<8;
Command=/attack;
Delay=5000;
SendKey=0x43;
Delay=25;
SendKey=0x43;
#ENDIF

Delay=1250;

Command=/select %Var[Odella];
Delay=125;
#IF=%TargetDistance,<8;
Command=/attack;
Delay=5000;
SendKey=0x43;
Delay=25;
SendKey=0x43;
#ENDIF

MoveTo=337.452,321.874,91,True,False;
Delay=450;
MoveTo=337.452,321.874,93.5,True,False;
Delay=450;
MoveTo=337.452,321.874,96,True,False;
Delay=450;

FlySmooth=336.19,336.7,96;
FlySmooth=336.19,336.7,96;
FlySmooth=332.971,344.429,96;
FlySmooth=332.971,344.429,96;

MoveTo=332.971,344.429,92.5,True,False;

Command=/select %Var[Odella];
Delay=125;
#IF=%TargetDistance,<8;
Command=/attack;
Delay=5000;
SendKey=0x43;
Delay=25;
SendKey=0x43;
#ENDIF

Delay=1250;

Command=/select %Var[Odella];
Delay=125;
#IF=%TargetDistance,<8;
Command=/attack;
Delay=5000;
SendKey=0x43;
Delay=25;
SendKey=0x43;
#ENDIF

MoveTo=332.971,344.429,96,True,False;
Delay=650;

FlySmooth=331.839,356.701,96;
FlySmooth=331.839,356.701,96;
Delay=21000; <-- waits for reset on all mobs
FlySmooth=328.47,367.873,96;
MoveTo=328.47,367.873,88.763,False,False;

FlySmooth=323.09,390.681,89.469;
FlySmooth=314.711,398.921,87.099;
FlySmooth=310.068,403.395,86.201;
FlySmooth=301.256,411.888,87.186;
FlySmooth=292.427,419.424,89.125;

Command=/select %Var[MuMu Porter];
Delay=125;
_AutoCombat=;

#DO=7000;
_ACDetectIfAttacked=;
Delay=500;
#UNTIL=1,=2;

FlySmooth=289.17,421.587,89.629;
_ACDetectIfAttacked=;

#DO=30000;
Command=/select %Var[Gestanerk];
Delay=125;
Command=/attack;
Delay=750;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
#DO=30000;
DialogClick=;
Delay=650;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;

FlySmooth=276.002,425.403,90.125;
FlySmooth=276.002,425.403,90.125;

_IFQuestAtStep=60009,8;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 22 - Couldn't finish %Var[Quest60009];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#DO=40000;
Delay=500;
_UNTILMemPtrRead=%PlayerBase,%OffsetPosZ,FLOAT,>144;

FlySmooth=270.665,425.663,144.199;
FlySmooth=264.733,425.311,143.786;
FlySmooth=259.214,424.404,143.271;
FlySmooth=254.672,422.793,142.813;
FlySmooth=250.34,420.202,142.818;
FlySmooth=244.33,414.006,142.816;
FlySmooth=238.966,406.649,142.526;
FlySmooth=238.794,399.12,142.45;
FlySmooth=240.227,390.161,140.762;
FlySmooth=241.461,381.229,139.33;
FlySmooth=241.009,372.388,138.13;
FlySmooth=236.864,366.946,137.373;
FlySmooth=230.543,360.316,138.154;
FlySmooth=225.576,352.895,140.409;
FlySmooth=224.585,344.398,142.89;
FlySmooth=224.603,341.107,142.787;
FlySmooth=223.89,340.075,142.435;

UseSpeed=350;
MoveTo=223.89,340.075,143.582,True,False;
MoveTo=223.89,340.075,144.726,True,False;
MoveTo=223.89,340.075,145.87,True,False;
MoveTo=223.89,340.075,147.014,True,False;
MoveTo=223.89,340.075,148.173,True,False;
MoveTo=223.89,340.075,149.917,True,False;
UseSpeed=200;

FlySmooth=224.229,299.777,149.917;
FlySmooth=224.229,299.777,149.917;

MoveTo=224.229,299.777,145.892,True,False;
MoveTo=224.229,299.777,141.892,False,False;
UseSpeed=1;

Command=/select %Var[Overseer Nukiti];
Delay=125;
_AutoCombat=;
_ACDetectIfAttacked=;
Delay=1500;

Command=/select %Var[Hamerun the Bleeder];
Delay=125;
Command=/select %Var[Hamerun the Bleeder];
Delay=125;
_AutoCombat=;
Delay=2000;
SendKey=0x1B;
Delay=2000;
_ACDetectIfAttacked=;

_IFQuestAtStep=60009,9;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 23 - Couldn't finish %Var[Quest60009];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

FlySmooth=224.075,284.655,144.594;
FlySmooth=224.123,277.062,144.776;
FlySmooth=224.069,270.661,144.898;

_ACDetectIfAttacked=;

Command=/select %Var[Antique Treasure Chest];
Delay=125;
Command=/attack;
Delay=5500;
SendKey=0x43;
Delay=25;
SendKey=0x43;
Delay=25;
SendKey=0x43;
Delay=25;
SendKey=0x43;
Delay=25;

_ACDetectIfAttacked=;

FlySmooth=223.952,263.056,144.898;

_ACDetectIfAttacked=;

#EXECUTE=CheckGear;

#DO=60000;
Command=/select %Var[Haramel Exit];
Delay=115;
Command=/attack;
Delay=11500;
#UNTIL=%Position,872/1188/111.5;

end_Haramel;



start_AetherogeneticsLab;

MemPtrWrite=%AddrFrameName[spinel_indun_buff_dialog],0x28,142,BYTE; //Hide Buff window

#EXECUTE=CombatSort;
_ACMob_Looting=False;
_ACIgnoreAtDistance=15;

FlySmooth=379.671,230.901,155.413;
FlySmooth=373.138,230.658,152.29;
FlySmooth=366.316,230.384,149.6;
FlySmooth=363.583,230.312,148.479;
_ACCheckMob=;
FlySmooth=363.702,230.306,148.527;
FlySmooth=357.727,229.583,147.6;
FlySmooth=353.87,224.497,147.601;
FlySmooth=351.912,222.637,147.602;
FlySmooth=350.816,222.729,147.602;

Delay=500;

#DO=60000;
MemWrite=%AddrTargetID,169,WORD;
Delay=250;
SendKey=0x43;
Delay=500;
FlySmooth=346.13,223.623,146.658;
#UNTIL=%Position,346.13/223.623/146.658;

#IF=%Position,346.13/223.623/146.658;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 1 (instance AetherogeneticsLab) - Couldn't open the door with id 169;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=RemoveTarget;

Command=/Select Special Lab Defender;
Delay=500;
#DO=60000;
_IFMemPtrRead=%TargetBase,%OffsetPosX,FLOAT,336-337;
_IFMemPtrRead=%TargetBase,%OffsetPosY,FLOAT,224-227;
_SetVar=GoodValue,1;
#ELSE
Delay=500;
#EXECUTE=MoreCheck;
#ENDIF
#UNTIL=%Var[GoodValue],=1;

#DO=60000;
Delay=400;
#UNTIL=%TargetDistance,>25;

#DO=20000;
Command=/Select Special Lab Security Guard;
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=Special Lab Security Guard;
#EXECUTE=PullMobMagicalAetherogeneticsLab1;
_AutoCombat=;

#DO=5000;
_ACDetectIfAttacked=;
Delay=400;
#UNTIL=1,=2;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

FlySmooth=352.557,231.378,147.602;
FlySmooth=353.212,223.984,147.601;
FlySmooth=346.13,223.623,146.658;

_ACDetectIfAttacked=;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,50;
#EXECUTE=RegenerateFunc;

#DO=30000;
Command=/Select Special Lab Defender;
Delay=500;
#EXECUTE=PullMob;
#ENDIF

FlySmooth=338.661,233.219,144.151;

#DO=60000;
Command=/Select Special Lab Defender;
Delay=200;
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=Special Lab Defender;
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=Special Lab Defender;
_AutoCombat=;
#ENDIF

#DO=6000;
_ACDetectIfAttacked=;
Delay=400;
#UNTIL=1,=2;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_ACDetectIfAttacked=;
FlySmooth=335.341,238.576,144.15;
FlySmooth=328.891,237.725,144.149;
FlySmooth=323.015,234.814,144.146;
FlySmooth=321.553,234.046,144.146;
FlySmooth=321.307,233.917,144.146;
_ACCheckMob=;

_ACDetectIfAttacked=;
FlySmooth=321.307,233.917,144.146;
FlySmooth=322.978,231.765,144.146;
FlySmooth=327.837,227.369,144.148;
FlySmooth=331.663,223.796,144.149;
_ACDetectIfAttacked=;

_ACDetectIfAttacked=;
FlySmooth=331.663,223.796,144.149;
FlySmooth=332.824,221.331,144.149;
FlySmooth=335.101,214.911,144.176;
FlySmooth=336.015,211.193,144.176;
FlySmooth=340.115,211.127,144.176;
FlySmooth=343.382,207.873,144.238;

#DO=60000;
Command=/Select Special Lab Assassin;
#UNTIL=%TargetDistance,>19;

#DO=20000;
Command=/Select Expert Lab Medic;
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=Expert Lab Medic;
#EXECUTE=PullMob;


#DO=10000;
_ACDetectIfAttacked=;
Delay=400;
#UNTIL=1,=2;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;


#DO=60000;
Command=/Select Special Lab Assassin;
#UNTIL=%TargetDistance,<15;
#EXECUTE=PullMob;


#DO=10000;
_ACDetectIfAttacked=;
Delay=400;
#UNTIL=1,=2;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

FlySmooth=346.031,200.409,141.872;
FlySmooth=349.468,199.517,141.872;

#DO=20000;
Command=/Select Special Lab Overseer;
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=Special Lab Overseer;
_AutoCombat=;

#DO=10000;
_ACDetectIfAttacked=;
Delay=400;
#UNTIL=1,=2;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_ACMob_Looting=True;

_ACDetectIfAttacked=;
FlySmooth=366.103,200.05,141.872;
FlySmooth=365.174,198.278,141.872;
FlySmooth=360.745,195.848,141.872;
FlySmooth=356.741,193.823,141.872;
FlySmooth=356.57,189.433,141.872;
FlySmooth=356.759,183.157,141.872;
#DO=60000;
Command=/select %Var[The Keykeeper];
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[The Keykeeper];
_AutoCombat=;
#EXECUTE=Loot;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_ACMob_Looting=False;

FlySmooth=359.123,174.592,141.872;
FlySmooth=358.252,177.254,141.872;
FlySmooth=352.373,178.914,141.872;
FlySmooth=348.024,179.493,141.872;
FlySmooth=342.629,180.211,141.872;
FlySmooth=341.508,179.435,141.872;
_ACCheckMob=;

#DO=5000;
_ACDetectIfAttacked=;
Delay=400;
#UNTIL=1,=2;

_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,50;
#EXECUTE=RegenerateFunc;

FlySmooth=338.596,180.192,141.872;
FlySmooth=334.362,181.292,141.872;
_ACCheckMob=;

#DO=10000;
_ACDetectIfAttacked=;
Delay=400;
#UNTIL=1,=2;

_SetVar=MpSitting,50;
_SetVar=HpSitting,50;
#EXECUTE=RegenerateFunc;

FlySmooth=334.362,181.292,141.872;
FlySmooth=331.697,182.661,141.872;
FlySmooth=326.04,185.213,141.872;
FlySmooth=321.423,188.146,141.872;
FlySmooth=321.78,193.58,141.872;
FlySmooth=322.878,200.005,141.872;
FlySmooth=324.029,206.745,143.725;
_ACDetectIfAttacked=;
FlySmooth=324.927,210.183,144.176;
FlySmooth=329.024,211.717,144.176;
FlySmooth=333.543,213.602,144.176;
FlySmooth=334.13,217.366,144.214;
FlySmooth=334.278,223.919,144.15;
FlySmooth=334.278,223.919,144.15;
_ACDetectIfAttacked=;
FlySmooth=334.278,223.919,144.15;
FlySmooth=334.194,223.865,144.15;
FlySmooth=333.955,230.117,144.15;
_ACDetectIfAttacked=;
FlySmooth=333.676,236.673,144.15;
FlySmooth=333.762,240.211,144.151;
_ACDetectIfAttacked=;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window

Delay=1000;
_SetVar=MpSitting,50;
_SetVar=HpSitting,50;
#EXECUTE=RegenerateFunc;
Delay=500;

#DO=60000;
MemWrite=%AddrTargetID,168,WORD;
Delay=250;
SendKey=0x43;
Delay=500;
FlySmooth=334.1,251.081,144.197;
#UNTIL=%Position,334.1/251.081/144.197;

#IF=%Position,334.1/251.081/144.197;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 2 (instance AetherogeneticsLab) - Couldn't open the door with id 168;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=RemoveTarget;

FlySmooth=334.086,251.902,144.238;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window

_ACCheckMob=;

#DO=6000;
_ACDetectIfAttacked=;
Delay=400;
#UNTIL=1,=2;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

FlySmooth=334.036,251.608,144.237;
FlySmooth=334.019,254.887,143.152;
FlySmooth=336.16,260.853,141.974;
FlySmooth=340.965,258.236,141.978;
FlySmooth=345.199,257.314,141.983;
_ACCheckMob=;

#DO=5000;
_ACDetectIfAttacked=;
Delay=400;
#UNTIL=1,=2;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_ACMob_Looting=True;

FlySmooth=345.199,257.314,141.983;
FlySmooth=344.141,263.229,141.987;
FlySmooth=343.628,268.382,141.986;
FlySmooth=349.817,268.342,141.981;
#DO=15000;
_ACDetectIfAttacked=;
Delay=300;
#UNTIL=1,=2;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

FlySmooth=343.619,268.662,141.986;
FlySmooth=343.42,273.304,141.983;
FlySmooth=343.32,275.493,141.982;
#DO=5000;
_ACDetectIfAttacked=;
Delay=300;
#UNTIL=1,=2;

_SetVar=temp,0;
#DO=60000;
Command=/select %Var[Librarian Selima];
Delay=55;
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[Librarian Selima];
_AutoCombat=;
#ENDIF
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[Librarian Selima];
_IFMemPtrRead=%TargetBase,%OffsetHP,DWORD,=0;
_SetVar=temp,1;
#ENDIF
#UNTIL=%Var[temp],=1;

#DO=60000;
#EXECUTE=RemoveTarget;
Delay=55;
Command=/select %Var[Librarian Selima];
Delay=55;
_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[Librarian Selima];
_IFMemPtrRead=%TargetBase,%OffsetHP,DWORD,=0;
#EXECUTE=Loot;
#ENDIF
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=;

_ACMob_Looting=False;

FlySmooth=344.845,275.419,141.981;
FlySmooth=340.477,275.503,141.985;
FlySmooth=333.931,275.618,141.985;
FlySmooth=329.829,275.69,141.98;

#DO=1800000;
_ACDetectIfAttacked=;
Delay=200;
Command=/select %Var[Lepharist Research Diary];
Delay=125;
Command=/attack;
Delay=7000;
DialogClick=;
Delay=600;
DialogClick=;
_IFQuestAtStep=61700,1;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;

#EXECUTE=RemoveTarget;

FlySmooth=329.882,275.833,141.98;
FlySmooth=333.368,275.186,141.984;
FlySmooth=340.185,274.886,141.985;
FlySmooth=342.014,273.792,141.984;
FlySmooth=341.841,266.969,141.988;
FlySmooth=341.769,260.973,141.982;
FlySmooth=340.003,260.272,141.979;
FlySmooth=334.596,258.529,141.969;
FlySmooth=334.473,256.08,142.633;
FlySmooth=334.268,249.531,144.197;
FlySmooth=334.269,242.726,144.214;
FlySmooth=334.269,236.166,144.15;
FlySmooth=334.27,229.876,144.15;
Delay=50;
_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;
Delay=50;
FlySmooth=334.27,229.876,144.15;
FlySmooth=334.27,229.876,144.15;
FlySmooth=328.258,230.059,144.148;
FlySmooth=321.684,230.225,144.146;
FlySmooth=319.77,230.273,144.145;
FlySmooth=316.784,230.255,144.144;
FlySmooth=313.501,230.236,144.144;
_ACCheckMob=;
FlySmooth=310.765,230.219,144.333;
FlySmooth=310.765,230.219,144.333;
_ACCheckMob=;
_ACDetectIfAttacked=;

Delay=1000;

#DO=60000;
MemWrite=%AddrTargetID,167,WORD;
Delay=250;
SendKey=0x43;
Delay=500;
FlySmooth=292.877,229.963,140.585;
#UNTIL=%Position,292.877/229.963/140.585;

#IF=%Position,292.877/229.963/140.585;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 3 (instance AetherogeneticsLab) - Couldn't open the door with id 167;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF


_ACMob_Looting=True;

#EXECUTE=RemoveTarget;

FlySmooth=286.297,230.002,138.857;
FlySmooth=279.74,230.113,137.136;
FlySmooth=278.377,230.137,136.834;
_ACCheckMob=;

#DO=10000;
_ACDetectIfAttacked=;
Delay=300;
#UNTIL=1,=2;

FlySmooth=278.377,230.137,136.834;
FlySmooth=274.106,231.143,136.756;
_ACDetectIfAttacked=;
FlySmooth=270.415,237.442,136.756;
FlySmooth=268.189,244.286,136.756;
_ACDetectIfAttacked=;
FlySmooth=262.91,244.897,136.96;
FlySmooth=254.986,244.97,133.657;
_ACDetectIfAttacked=;
FlySmooth=249.313,244.925,132.834;
FlySmooth=248.578,246.074,132.835;
Command=/select Pretor Lab Sentry;
#EXECUTE=PullMob;
FlySmooth=247.404,247.649,132.835;
_ACDetectIfAttacked=;
_SetVar=MpSitting,50;
_SetVar=HpSitting,70;
#EXECUTE=RegenerateFunc;
FlySmooth=243.378,252.818,132.835;
_ACDetectIfAttacked=;
FlySmooth=239.362,252.777,132.834;
_ACDetectIfAttacked=;
FlySmooth=236.947,252.359,132.834;
Command=/select Pretor Lab Sentry;
#EXECUTE=PullMob;
FlySmooth=236.947,252.359,132.834;
FlySmooth=231.404,252.016,132.834;
_ACDetectIfAttacked=;
_SetVar=MpSitting,50;
_SetVar=HpSitting,70;
#EXECUTE=RegenerateFunc;
FlySmooth=223.484,251.727,132.834;
FlySmooth=222.602,251.708,132.834;
_ACDetectIfAttacked=;
FlySmooth=219.407,250.347,132.834;
FlySmooth=219.102,249.819,132.834;
Command=/select Pretor Lab Sentry;
#EXECUTE=PullMob;
Delay=500;
Command=/select Pretor Lab Sentry;
#EXECUTE=PullMob;
_SetVar=MpSitting,50;
_SetVar=HpSitting,70;
#EXECUTE=RegenerateFunc;
FlySmooth=216.399,249.515,132.834;
Command=/select Pretor Key Keeper;
_AutoCombat=;
#EXECUTE=Loot;
FlySmooth=203.7,246.199,132.834;

Delay=1000;

_ACMob_Looting=False;

#DO=60000;
MemWrite=%AddrTargetID,172,WORD;
Delay=250;
SendKey=0x43;
Delay=500;
FlySmooth=196.896,245.778,132.602;
_UNTILMemPtrRead=%PlayerBase,%OffsetPosX,FLOAT,<198;

_IFMemPtrRead=%PlayerBase,%OffsetPosX,FLOAT,<198;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 4 (instance AetherogeneticsLab) - Couldn't open the door with id 172;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=RemoveTarget;

_SetVar=MpSitting,50;
_SetVar=HpSitting,70;
#EXECUTE=RegenerateFunc;

#DO=60000;
Command=/select Expert Lab Scholar;
#IF=%TargetDistance,<9;
_AutoCombat=;
_SetVar=isScholarDead,1;
#ELSE
_SetVar=isScholarDead,0;
#ENDIF
#UNTIL=%Var[isScholarDead],=1;

FlySmooth=195.869,242.537,132.602;
FlySmooth=194.04,234.758,132.602;
_ACDetectIfAttacked=;
FlySmooth=192.341,226.991,132.602;
FlySmooth=192.191,226.258,132.602;
_ACDetectIfAttacked=;
FlySmooth=187.986,226.423,132.602;
FlySmooth=187.899,226.426,132.602;
Delay=400;
Command=/select Expert Lab Scholar;
_AutoCombat=;

#DO=10000;
_ACDetectIfAttacked=;
Delay=200;
_UNTILMemPtrRead=%TargetBase,%OffsetLevel,DWORD,=80;
FlySmooth=181.273,224.633,132.855;
_SetVar=MpSitting,50;
_SetVar=HpSitting,70;
#EXECUTE=RegenerateFunc;
FlySmooth=181.273,224.633,132.855;
Delay=500;

_ACDetectIfAttacked=;
FlySmooth=181.273,224.633,132.855;
#DO=600000;
Delay=250;
Command=/select %Var[Giant Flask];
Delay=300;
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[Giant Flask];
FlySmooth=181.273,224.633,132.855;
_AutoCombat=;
Delay=600;

#DO=600000;
Command=/select %Var[RM-108c];
Delay=300;
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[RM-108c];
_AutoCombat=;
#EXECUTE=Loot;

FlySmooth=181.101,224.508,132.855;
FlySmooth=186.063,224.61,132.602;
FlySmooth=189.201,224.621,132.602;
_ACDetectIfAttacked=;
FlySmooth=189.623,230.589,132.602;
FlySmooth=189.609,237.136,132.602;
FlySmooth=189.6,241.228,132.602;
_ACDetectIfAttacked=;
FlySmooth=189.599,242.046,132.602;
FlySmooth=189.59,245.871,132.602;
FlySmooth=189.585,248.326,132.602;
_ACDetectIfAttacked=;
FlySmooth=189.582,249.709,132.602;
FlySmooth=189.577,252.448,132.602;
FlySmooth=189.575,252.999,132.602;
_ACDetectIfAttacked=;
FlySmooth=189.575,252.999,132.602;
_ACDetectIfAttacked=;
FlySmooth=189.562,259.292,132.783;
FlySmooth=189.548,266.019,131.727;
_ACDetectIfAttacked=;
FlySmooth=189.502,272.576,130.006;
FlySmooth=189.305,277.757,128.647;
_ACDetectIfAttacked=;
FlySmooth=189.249,279.132,128.286;

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window

FlySmooth=189.249,279.132,128.286;
FlySmooth=188.792,285.407,126.639;
FlySmooth=188.5,291.951,125.148;
FlySmooth=188.423,297.676,124.855;
_ACCheckMob=;

_ACDetectIfAttacked=;

Delay=%Var[WaitAfterDetectOrCheckMob];

_ACCheckMob=;

_ACDetectIfAttacked=;

#DO=1800000;
#EXECUTE=LepharistFarmspot3;
_IFQuestAtStep=61701,1;
_SetVar=TempFinished,1;
#ELSE
_SetVar=TempFinished,0;
#ENDIF
#UNTIL=%Var[TempFinished],=1;

_ACMob_Looting=False;

FlySmooth=198.532,297.491,124.855;
FlySmooth=196.8,302.11,124.855;
FlySmooth=196.034,304.153,124.855;
FlySmooth=195.646,309.044,124.855;
FlySmooth=195.402,315.581,124.855;
FlySmooth=195.533,321.056,124.855;
FlySmooth=195.702,322.953,124.855;
FlySmooth=201.361,323.277,125.263;
_ACDetectIfAttacked=;

Delay=%Var[WaitAfterDetectOrCheckMob];

_SetVar=HpSitting,90;
_SetVar=MpSitting,10;
#EXECUTE=RegenerateFunc;
Delay=1000;

#DO=60000;
MemWrite=%AddrTargetID,171,WORD;
Delay=250;
SendKey=0x43;
Delay=500;
FlySmooth=206.85,323.402,124.997;
#UNTIL=%Position,206.85/323.402/124.997;

#IF=%Position,206.85/323.402/124.997;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 5 (instance AetherogeneticsLab) - Couldn't open the door with id 171;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

#EXECUTE=RemoveTarget;


FlySmooth=206.85,323.402,124.997;
FlySmooth=206.85,323.402,124.997;

#DO=60000;
Command=/select %Var[Perfected Pretor];
Delay=300;
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[Perfected Pretor];
_AutoCombat=;

#DO=60000;
_ACDetectIfAttacked=;
Delay=200;
#UNTIL=1,=2;

_SetVar=HpSitting,90;
_SetVar=MpSitting,10;
#EXECUTE=RegenerateFunc;

FlySmooth=209.209,323.316,124.997;
FlySmooth=212.752,323.217,124.997;
FlySmooth=219.58,323.026,124.997;
FlySmooth=226.145,322.842,124.997;
FlySmooth=232.888,322.654,124.997;
FlySmooth=233.977,322.623,124.997;

#DO=60000;
Command=/select %Var[RM-78c];
Delay=300;
_UNTILMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=%Var[RM-78c];
_AutoCombat=;
#EXECUTE=Loot;


MoveTo=233.977,322.623,124.997,True,False;
MemPtrWrite=%PlayerBase,%OffsetPosZ,132.897,FLOAT;

#DO=10000;
Delay=500;
_UNTILMemRead=%AddrCurrentEXP,UINT64,=0;

MoveTo=233.977,322.623,132.897,False,False;
MoveTo=233.977,322.623,132.897,False,False;
MoveTo=233.977,322.623,132.897,False,False;

Delay=500;

FlySmooth=239.367,322.604,124.997;
FlySmooth=244.269,322.76,124.997;
FlySmooth=251.065,322.976,127.323;
FlySmooth=253.397,322.908,127.272;

#DO=60000;
Command=/select %Var[Exit];
Delay=125;
Command=/attack;
Delay=7000;
#UNTIL=%Position,416/920/122.5;

#IF=%Position,416/920/122.5;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 6 (instance AetherogeneticsLab) - Couldn't teleport outside the instance;
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

Delay=5000;

_SetVar=HpSitting,30;
_SetVar=MpSitting,35;

end_AetherogeneticsLab;

start_PullMob;

#IF=%TargetDistance,<18;
_IFMemPtrRead=%TargetBase,%OffsetHP,BYTE,>0;
#DO=60000;
SmartSkill=4128,12000,0,False,False;
Delay=400;
#UNTIL=%TargetDistance,<5;
_AutoCombat=;
#ENDIF

end_PullMob;

start_PullMobMagicalAetherogeneticsLab1;

_MemPtrReadVar=%PlayerBase,%OffsetData/0x30,WORD,29;
#DO=60000;
SmartSkill=4128,12000,0,False,False;
FlySmooth=353.212,223.984,147.601;
_UNTILMemPtrRead=%AddrFrameName[target_assist_dialog],0x560,WORD,=%Var29;

#DO=60000;
SmartSkill=4128,12000,0,False,False;
Delay=400;
FlySmooth=352.557,231.378,147.602;
#UNTIL=%TargetDistance,<7;

end_PullMobMagicalAetherogeneticsLab1;

start_Loot;

#IF=%Var[Loot_Enabled],=1;
_SetVar=Loot_Finished,0;
_IFMemPtrRead=%TargetBase,%OffsetHP,DWORD,=0; Dead
_IFMemPtrRead=%TargetBase,%OffsetData/0x15B8,DWORD,=1; Lootable
_IFMemPtrRead=%TargetBase,%OffsetData/0x15CC,DWORD,=0; <-- Loot table not received yet
_MemReadVar=%AddrTargetID,WORD,TargetIDCache;
#DO=10000;
#EXECUTE=Looting;
#UNTIL=%Var[Loot_Finished],=1;
#EXECUTE=RemoveTarget;
#ENDIF

end_Loot;


start_Looting;

MemPtrWrite=%PlayerBase,%OffsetActionID,0x150000000100000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002,BYTE[225];
Delay=250;
UseID=50002;
Delay=250;

_IFMemPtrRead=%TargetBase,%OffsetData/0x15D0,DWORD,>0; <-- Loot table received
_IFMemPtrRead=%TargetBase,%OffsetData/0x15B8,DWORD,=0; <-- Not lootable anymore
_SetVar=Loot_Finished,1;
#ENDIF

_IFMemRead=%AddrTargetID,WORD,=%Var[TargetIDCache]; <-- Lost target
#ELSE
_SetVar=Loot_Finished,1;
#ENDIF

_IFMemPtrRead=%AddrFrameName[loot_dialog],0x28,BYTE,=175;
SendKey=0x43;
Delay=5;
SendKey=0x43;
Delay=5;
SendKey=0x43;
Delay=5;
SendKey=0x43;
Delay=15;
_SetVar=Loot_Finished,1;
_IFMemPtrRead=%AddrFrameID[%ConfirmFrameID],0x28,BYTE,=175;
SendKey=0x0D;
Delay=50;
SendKey=0x0D;
Delay=50;
Command=;
SendKey=0x1B;
MemPtrWrite=%AddrFrameName[system_menu_dialog],0x28,142,BYTE;
#ENDIF

FrameActionByName=system_menu_dialog,STATE,SHOW;

_IFMemPtrRead=%AddrFrameID[%ConfirmFrameID],0x28,BYTE,=175;
SendKey=0x0D;
Delay=50;
SendKey=0x0D;
Delay=50;
Command=;
SendKey=0x1B;
MemPtrWrite=%AddrFrameName[system_menu_dialog],0x28,142,BYTE;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetHP,DWORD,=0;
_SetVar=Loot_Finished,1;
#ENDIF

end_Looting;

start_MoreCheck;

_IFMemPtrRead=%TargetBase,%OffsetName,WCHAR[64],=Special Lab Defender;
_IFMemPtrRead=%TargetBase,%OffsetHP,BYTE,=0;
SendKey=0x09;
Delay=500;
#ELSE
#ENDIF

#DO=60000;
#2DO=60000;
Command=/Select Special Lab Defender;
Delay=500;
_UNTILMemPtrRead=%TargetBase,%OffsetPosX,FLOAT,336-337;
_2UNTILMemPtrRead=%TargetBase,%OffsetPosY,FLOAT,224-227;

end_MoreCheck;

start_FarmSpot3;

_ACMob_Looting=True;
MoveSmooth=422,1853;
MoveSmooth=419,1854;
MoveSmooth=416,1855;
MoveSmooth=413,1857;
MoveSmooth=410,1858;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=408,1860;
MoveSmooth=405,1862;
MoveSmooth=401,1863;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=398,1865;
MoveSmooth=395,1868;
MoveSmooth=392,1869;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=390,1872;
MoveSmooth=386,1874;
MoveSmooth=383,1876;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=381,1879;
MoveSmooth=378,1882;
MoveSmooth=375,1885;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=373,1888;
MoveSmooth=370,1891;
MoveSmooth=368,1894;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=366,1898;
MoveSmooth=364,1901;
MoveSmooth=362,1904;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=360,1908;
MoveSmooth=358,1911;
MoveSmooth=356,1915;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=355,1919;
MoveSmooth=353,1922;
MoveSmooth=352,1926;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=351,1929;
MoveSmooth=349,1933;
MoveSmooth=348,1937;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=347,1941;
MoveSmooth=346,1945;
MoveSmooth=345,1948;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=344,1952;
MoveSmooth=343,1956;
MoveSmooth=342,1960;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=341,1964;
MoveSmooth=340,1967;
MoveSmooth=340,1970;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=339,1974;
MoveSmooth=339,1977;
MoveSmooth=338,1981;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=338,1984;
MoveSmooth=337,1988;
MoveSmooth=335,1991;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=332,1994;
MoveSmooth=330,1998;
MoveSmooth=329,2001;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=327,2005;
MoveSmooth=325,2008;
MoveSmooth=324,2012;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=322,2016;
MoveSmooth=320,2019;
MoveSmooth=318,2023;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=316,2026;
MoveSmooth=312,2028;
MoveSmooth=309,2030;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=305,2031;
MoveSmooth=302,2033;
MoveSmooth=298,2034;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=294,2035;
MoveSmooth=290,2035;
MoveSmooth=286,2036;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=282,2036;
MoveSmooth=278,2036;
MoveSmooth=275,2035;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=272,2033;
MoveSmooth=269,2030;
MoveSmooth=268,2027;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=268,2023;
MoveSmooth=269,2019;
MoveSmooth=270,2015;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=269,2012;
MoveSmooth=269,2008;
MoveSmooth=270,2004;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=271,2001;
MoveSmooth=272,1998;
MoveSmooth=274,1994;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=276,1991;
MoveSmooth=279,1988;
MoveSmooth=280,1984;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=283,1981;
MoveSmooth=287,1980;
MoveSmooth=291,1980;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=294,1980;
MoveSmooth=297,1981;
MoveSmooth=301,1981;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
_SetVar=temp,1;
#Return
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=304,1980;
MoveSmooth=308,1980;
MoveSmooth=311,1980;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=315,1980;
MoveSmooth=318,1981;
MoveSmooth=322,1982;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=325,1983;
MoveSmooth=329,1982;
MoveSmooth=333,1979;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=336,1977;
MoveSmooth=340,1977;
MoveSmooth=343,1976;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=346,1974;
MoveSmooth=347,1971;
MoveSmooth=345,1968;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=346,1964;
MoveSmooth=347,1960;
MoveSmooth=348,1956;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=349,1952;
MoveSmooth=349,1948;
MoveSmooth=350,1944;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=351,1941;
MoveSmooth=351,1937;
MoveSmooth=352,1933;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=353,1929;
MoveSmooth=354,1925;
MoveSmooth=355,1921;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=356,1917;
MoveSmooth=357,1914;
MoveSmooth=359,1910;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=360,1906;
MoveSmooth=362,1903;
MoveSmooth=364,1899;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=367,1897;
MoveSmooth=370,1894;
MoveSmooth=372,1891;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=375,1888;
MoveSmooth=378,1885;
MoveSmooth=381,1882;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=384,1880;
MoveSmooth=387,1877;
MoveSmooth=390,1875;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=393,1872;
MoveSmooth=396,1870;
MoveSmooth=399,1867;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=402,1865;
MoveSmooth=406,1863;
MoveSmooth=409,1861;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=410,1862;
MoveSmooth=414,1860;
MoveSmooth=417,1857;
_IFQuestInventoryContains=182216251,3;
_IFQuestInventoryContains=182216252,1;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=418,1856;

_ACMob_Looting=False;

end_FarmSpot3;





start_FarmSpot2;

_ACMob_Looting=True;
_ACIgnoreAtDistance=33;

FlySmooth=573.962,1638.838,117.125;
MemWrite=%AddrCamX,-170,FLOAT;
MemWrite=%AddrCamY,11,FLOAT;
MemPtrWrite=%AddrCamMax,%OffsetCamMax,44,FLOAT;
MemPtrWrite=%AddrThirdPerson,%OffsetThirdPerson,16,FLOAT;
_ACCheckMob=;
FlySmooth=573.962,1638.838,117.125;

_ACIgnoreAtDistance=25;
_ACMob_Looting=False;

end_FarmSpot2;












start_FarmSpot1;

MoveSmooth=767,1221;
MoveSmooth=767,1223;
MoveSmooth=767,1226;
MoveSmooth=768,1229;
MoveSmooth=768,1232;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=767,1235;
MoveSmooth=766,1238;
MoveSmooth=765,1241;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=764,1243;
MoveSmooth=763,1246;
MoveSmooth=763,1249;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=762,1252;
MoveSmooth=760,1254;
MoveSmooth=757,1255;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=754,1255;
MoveSmooth=751,1254;
MoveSmooth=748,1252;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=745,1251;
MoveSmooth=743,1249;
MoveSmooth=741,1247;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=739,1245;
MoveSmooth=737,1243;
MoveSmooth=735,1240;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=733,1238;
MoveSmooth=731,1236;
MoveSmooth=729,1233;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=727,1231;
MoveSmooth=726,1228;
MoveSmooth=725,1225;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=724,1222;
MoveSmooth=723,1219;
MoveSmooth=722,1216;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=721,1214;
MoveSmooth=720,1211;
MoveSmooth=719,1208;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=718,1205;
MoveSmooth=718,1202;
MoveSmooth=719,1200;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=722,1198;
MoveSmooth=725,1197;
MoveSmooth=728,1196;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=731,1195;
MoveSmooth=734,1195;
MoveSmooth=737,1196;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=739,1198;
MoveSmooth=741,1200;
MoveSmooth=744,1202;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=746,1204;
MoveSmooth=748,1206;
MoveSmooth=751,1208;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=753,1210;
MoveSmooth=756,1211;
MoveSmooth=759,1212;
_IFQuestAtStep=60005,3;
_ACDetectIfAttacked=;
#ELSE
_ACCheckMob=;
#ENDIF
MoveSmooth=761,1214;
MoveSmooth=763,1216;
MoveSmooth=764,1219;

end_FarmSpot1;

start_HeironFarmspot1;

_IFQuestAtStep=61622,2;
#ELSE
#EXECUTE=CheckNpcNearMeGunes;
#ENDIF

end_HeironFarmspot1;

start_HeironFarmspot2Ettins;

_SetVar=WaitAfterDetectOrCheckMob,300;
#EXECUTE=CombatSort;
_ACMob_Whitelist=Whitehawk Ettin,Cracktooth Ettin;

FlySmooth=2619.715,422.594,406.053;
FlySmooth=2629.822,430.644,404.283;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2642.679,428.502,402.509;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2653.353,432.607,400.17;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2658.219,444.797,397.561;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2658.776,457.908,397.173;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2657.601,471.074,392.585;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2657.354,484.31,385.547;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2657.123,497.725,382.601;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2656.821,510.935,379.27;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2656.788,524.1,372.29;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2660.737,536.316,367.875;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2662.882,546.881,367.695;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2650.125,549.894,366.78;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2644.943,540.435,367.13;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2651.287,528.909,369.659;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2653.618,515.951,376.456;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2655.034,502.834,382.601;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2655.621,489.651,382.646;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2655.795,476.416,389.681;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2656.418,462.961,396.849;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2655.476,449.814,397.5;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2651.048,437.413,400.002;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2644.462,426.541,402.38;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2645.366,413.392,402.572;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2636.091,415.111,404.169;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2622.997,417.636,405.648;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2610.027,419.476,407.498;
_ACDetectIfAttacked=;

_IFQuestAtStep=61623,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=2609.733,420.064,407.533;
_ACDetectIfAttacked=;

end_HeironFarmspot2Ettins;

start_HeironFarmspot3PoyaJungle;


#EXECUTE=CombatSort;
_ACMob_Whitelist=Thorned Moonflower,Pincerjaw Laupede;

FlySmooth=1420.074,1137.813,138.769;
FlySmooth=1427.078,1131.511,140.483;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1433.164,1123.67,142.489;
FlySmooth=1436.355,1114.593,143.147;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1438.606,1106.037,143.076;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1435.971,1097.563,142.953;
FlySmooth=1431.02,1088.972,143.125;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1425.51,1081.23,143.018;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1421.685,1073.197,142.816;
FlySmooth=1423.075,1064.242,143.009;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1425.974,1054.752,142.591;
FlySmooth=1425.705,1044.948,141.666;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1417.631,1041.557,140.982;
FlySmooth=1409.739,1047.433,140.609;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1402.177,1053.796,140.599;
FlySmooth=1393.837,1059.159,135.753;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1384.015,1059.432,135.553;
FlySmooth=1374.203,1057.781,134.982;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1364.352,1057.809,134.08;
FlySmooth=1356.734,1063.639,131.5;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1353.211,1072.947,129.017;
FlySmooth=1349.396,1082.219,128.625;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1345.26,1090.507,128.657;
FlySmooth=1345.669,1099.058,129.191;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1352.421,1106.356,129.496;
FlySmooth=1359.89,1113.044,129.565;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1367.502,1119.4,130.05;
FlySmooth=1375.515,1125.289,131.086;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1383.721,1130.817,131.818;
FlySmooth=1392.693,1135.391,132.722;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1402.205,1137.955,134.658;
FlySmooth=1412.01,1138.988,136.752;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1421.691,1137.195,139.173;
FlySmooth=1422.591,1137.154,139.398;
_ACDetectIfAttacked=;

_IFQuestAtStep=61602,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF;
FlySmooth=1422.23,1137.213,139.308;

end_HeironFarmspot3PoyaJungle;

start_LepharistFarmspot1;

FlySmooth=892.651,721.776,124.264;
FlySmooth=886.538,722.595,124.358;
_ACDetectIfAttacked=;

_IFQuestInventoryContains=182216579,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=881.16,725.528,124.667;
FlySmooth=874.374,725.251,124.75;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestInventoryContains=182216579,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=867.841,724.606,124.893;
FlySmooth=862.083,723.487,124.794;
_ACDetectIfAttacked=;

_IFQuestInventoryContains=182216579,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=856.167,725.041,125.935;
FlySmooth=852.013,728.866,126.623;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestInventoryContains=182216579,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=853.011,734.585,126.077;
FlySmooth=856.608,740.026,125.046;
_ACDetectIfAttacked=;

_IFQuestInventoryContains=182216579,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=860.909,745.119,124.948;
FlySmooth=867.309,746.515,125.743;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestInventoryContains=182216579,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=872.757,745,125.776;
FlySmooth=879.271,745.78,126.729;
_ACDetectIfAttacked=;

_IFQuestInventoryContains=182216579,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=885.703,746.926,128.426;
FlySmooth=891.691,746.529,130.102;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestInventoryContains=182216579,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=892.508,740.435,129.686;
FlySmooth=892.149,733.633,127.923;
_ACDetectIfAttacked=;

_IFQuestInventoryContains=182216579,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=892.178,727.105,124.515;
FlySmooth=892.439,720.606,124.457;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestInventoryContains=182216579,1;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=892.082,718.732,124.768;
FlySmooth=891.555,718.615,124.77;

end_LepharistFarmspot1;

start_LepharistFarmspot2;

_ACDetectIfAttacked=;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=588.611,1008.236,134.987;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Toxic Slime;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=587.882,1011.262,134.954;
_ACDetectIfAttacked=;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Toxic Slime;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=585.773,1016.734,135;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
_ACCheckMob=;
#ENDIF
FlySmooth=584.873,1022.391,135;
FlySmooth=584.477,1028.168,135;
_ACDetectIfAttacked=;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=585.844,1033.897,135;
FlySmooth=585.67,1039.599,135;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=584.102,1045.46,135;
FlySmooth=582.902,1051.225,135.048;
_ACDetectIfAttacked=;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=582.829,1056.931,135;
FlySmooth=588.077,1055.538,135;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=593.758,1053.452,135;
FlySmooth=600.371,1053.749,135.135;
_ACDetectIfAttacked=;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=606.989,1053.849,135.135;
FlySmooth=610.794,1051.689,135.135;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=605.252,1049.686,135.145;
FlySmooth=599.334,1050.77,135.135;
_ACDetectIfAttacked=;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=593.863,1049.273,135;
FlySmooth=591.674,1043.762,135;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=591.92,1037.709,135;
FlySmooth=596.923,1033.516,135;
_ACDetectIfAttacked=;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=601.416,1028.542,135;
FlySmooth=602.825,1022.042,135.178;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=600.116,1016.132,134.875;
FlySmooth=595.707,1010.936,134.875;
_ACDetectIfAttacked=;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=590.033,1008.058,134.987;
FlySmooth=590.261,1009.783,135.129;
_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

_IFQuestAtStep=61604,2;
#ELSE
Delay=%Var[WaitAfterDetectOrCheckMob];
Command=/select Test Subject Kirrin;
#EXECUTE=PullMob;

#ENDIF
FlySmooth=589.382,1010.467,134.904;

_ACDetectIfAttacked=;

_ACDetectIfAttacked=;

_ACDetectIfAttacked=;

_SetVar=MpSitting,50;
_SetVar=HpSitting,60;
#EXECUTE=RegenerateFunc;

end_LepharistFarmspot2;

start_LepharistFarmspot3;

_ACMob_Looting=True;

FlySmooth=188.423,297.676,124.855;
_ACDetectIfAttacked=;
FlySmooth=192.816,297.507,124.855;
_ACDetectIfAttacked=;
FlySmooth=197.733,297.335,124.855;
_ACDetectIfAttacked=;
FlySmooth=198.27,297.316,124.855;
_ACDetectIfAttacked=;

#DO=5000;
_ACDetectIfAttacked=;
Delay=300;
#UNTIL=1,=2;

Delay=500;
_IFQuestAtStep=61701,1;
#ELSE
Command=/select %Var[Lepharist Research Data];
Delay=125;
Command=/attack;
Delay=7000;
#ENDIF
_ACDetectIfAttacked=;
FlySmooth=198.27,297.316,124.855;
_ACDetectIfAttacked=;
FlySmooth=197.517,301.62,124.855;
_ACDetectIfAttacked=;
FlySmooth=196.577,308.113,124.855;
_ACDetectIfAttacked=;
FlySmooth=196.402,312.205,124.855;
_ACDetectIfAttacked=;
FlySmooth=196.241,318.76,124.855;
_ACDetectIfAttacked=;
FlySmooth=196.08,325.322,124.855;
_ACDetectIfAttacked=;
FlySmooth=195.919,331.883,124.855;
_ACDetectIfAttacked=;
FlySmooth=196.194,338.417,124.855;
_ACDetectIfAttacked=;
FlySmooth=198.911,344.384,124.855;
_ACDetectIfAttacked=;
FlySmooth=200.254,346.097,124.855;
_ACDetectIfAttacked=;

#DO=5000;
_ACDetectIfAttacked=;
Delay=300;
#UNTIL=1,=2;

Delay=500;
_IFQuestAtStep=61701,1;
#ELSE
Command=/select %Var[Lepharist Research Data];
Delay=125;
Command=/attack;
Delay=7000;
#ENDIF
_ACDetectIfAttacked=;
FlySmooth=200.254,346.097,124.855;
_ACDetectIfAttacked=;
FlySmooth=198.658,345.705,124.855;
_ACDetectIfAttacked=;
FlySmooth=192.113,345.218,124.855;
_ACDetectIfAttacked=;
FlySmooth=185.551,344.954,124.855;
_ACDetectIfAttacked=;
FlySmooth=179.921,342.329,124.855;
_ACDetectIfAttacked=;
FlySmooth=178.992,335.834,124.855;
_ACDetectIfAttacked=;
FlySmooth=178.406,329.32,124.855;
_ACDetectIfAttacked=;
FlySmooth=177.676,322.803,124.855;
_ACDetectIfAttacked=;
FlySmooth=177.676,322.803,124.855;
_ACDetectIfAttacked=;

#DO=10000;
_ACDetectIfAttacked=;
Delay=300;
#UNTIL=1,=2;

Delay=500;
_IFQuestAtStep=61701,1;
#ELSE
Command=/select %Var[Lepharist Research Data];
Delay=125;
Command=/attack;
Delay=7000;
#ENDIF
_ACDetectIfAttacked=;
FlySmooth=177.676,322.803,124.855;
_ACDetectIfAttacked=;
FlySmooth=177.698,317.873,124.855;
_ACDetectIfAttacked=;
FlySmooth=178.273,311.05,124.855;
_ACDetectIfAttacked=;
FlySmooth=179.06,304.545,124.855;
_ACDetectIfAttacked=;
FlySmooth=181.568,298.758,124.855;
_ACDetectIfAttacked=;
FlySmooth=188.26,297.963,124.855;
_ACDetectIfAttacked=;
FlySmooth=194.815,297.745,124.855;
_ACDetectIfAttacked=;
FlySmooth=199.715,297.336,124.855;
_ACDetectIfAttacked=;
FlySmooth=199.715,297.336,124.855;

#DO=5000;
_ACDetectIfAttacked=;
Delay=300;
#UNTIL=1,=2;

end_LepharistFarmspot3;

start_CheckGear;

_IFInventoryContains=188070365;
UseID=188070365;
Delay=2500;
Command=/Use Daeva Apprentice's Brogans;
Command=/Use Daeva Apprentice's Cloth Shoes;
Command=/Use Daeva Apprentice's Leather Footwear;
Command=/Use Daeva Apprentice's Leather Shoes;
Command=/Use Daeva Apprentice's Sabatons;
Command=/Use Apprentice's Boots;
Command=/Use Apprentice's Brogans;
Command=/Use Apprentice's Mystic Boots;
Command=/Use Apprentice's Sabatons;
Command=/Use Apprentice's Shoes;
Delay=500;
#ENDIF
_IFInventoryContains=188070362;
UseID=188070362;
Delay=2500;
Command=/Use Daeva Apprentice's Breeches;
Command=/Use Daeva Apprentice's Chausses;
Command=/Use Daeva Apprentice's Cloth Breeches;
Command=/Use Daeva Apprentice's Leather Legwear;
Command=/Use Daeva Apprentice's Plate Greaves;
Command=/Use Apprentice's Breeches;
Command=/Use Apprentice's Chausses;
Command=/Use Apprentice's Greaves;
Command=/Use Apprentice's Leggings;
Command=/Use Apprentice's Mystic Breeches;
Delay=500;
#ENDIF
_IFInventoryContains=188070364;
UseID=188070364;
Delay=2500;
Command=/Use Daeva Apprentice's Chain Gauntlets;
Command=/Use Daeva Apprentice's Cloth Gloves;
Command=/Use Daeva Apprentice's Leather Gauntlets;
Command=/Use Daeva Apprentice's Plate Gauntlets;
Command=/Use Daeva Apprentice's Vambraces;
Command=/Use Apprentice's Gauntlets;
Command=/Use Apprentice's Gloves;
Command=/Use Apprentice's Handguards;
Command=/Use Apprentice's Mystic Vambrace;
Command=/Use Apprentice's Vambrace;
Delay=500;
#ENDIF
_IFInventoryContains=188070360;
UseID=188070360;
Delay=2500;
Command=/Use Daeva Apprentice's Aether Revolver;
Command=/Use Daeva Apprentice's Dagger;
Command=/Use Daeva Apprentice's Longsword;
Command=/Use Daeva Apprentice's Mace;
Command=/Use Daeva Apprentice's Spellbook;
Command=/Use Apprentice's Pistol;
Command=/Use Apprentice's Dagger;
Command=/Use Apprentice's Sword;
Command=/Use Apprentice's Mace;
Command=/Use Apprentice's Spellbook;
Delay=500;
_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=15;
_SetVar=CheckArtistWeapon,1;
#ENDIF
#IF=%Var[CheckArtistWeapon],=1;
_IFMemRead=%AddrAtkspeed,WORD,<2400;
Command=/Use Daeva Apprentices Paint Rings;
Command=/Use Apprentice's Chromablaster;
_SetVar=CheckArtistWeapon,0;
Delay=500;
#ENDIF
#IF=%Var[CheckArtistWeapon],=1;
_IFMemRead=%AddrAtkspeed,WORD,>2399;
Command=/Use Daeva Apprentices Stringed Instrument;
Command=/Use Apprentice's Harp;
_SetVar=CheckArtistWeapon,0;
Delay=500;
#ENDIF
_IFInventoryContains=188070363;
UseID=188070363;
Delay=2500;
Command=/Use Daeva Apprentice's Cloth Shoulderpads;
Command=/Use Daeva Apprentice's Leather Epaulettes;
Command=/Use Daeva Apprentice's Shoulder Straps;
Command=/Use Daeva Apprentice's Shoulderplates;
Command=/Use Daeva Apprentice's Spaulders;
Command=/Use Apprentice's Mystic Shoulderguards;
Command=/Use Apprentice's Pauldrons;
Command=/Use Apprentice's Shoulderguards;
Command=/Use Apprentice's Shoulderplates;
Command=/Use Apprentice's Spaulders;
Delay=500;
#ENDIF
_IFInventoryContains=188052574;
UseID=188052574;
Delay=3500;
Command=/Use Hamerun's Crystal Earring;
Command=/Use Hamerun's Jewel Earring;
Command=/Use Hamerun's Crystal Earrings;
Command=/Use Hamerun's Jewel Earrings;
Delay=500;
#ENDIF
_IFInventoryContains=188070478;
UseID=188070478;
Delay=3500;
Command=/Use Ancient Hamerun Magic Earring;
Command=/Use Ancient Hamerun Magic Necklace;
Command=/Use Ancient Hamerun Magic Ring;
Command=/Use Ancient Hamerun Magic Sash;
Command=/Use Ancient Hamerun War Belt;
Command=/Use Ancient Hamerun War Earring;
Command=/Use Ancient Hamerun War Necklace;
Command=/Use Ancient Hamerun War Ring;
Command=/Use Ancient Hamerun's Earrings;
Command=/Use Ancient Hamerun's Mystic Earrings;
Command=/Use Ancient Hamerun's Mystic Necklace;
Command=/Use Ancient Hamerun's Mystic Ring;
Command=/Use Ancient Hamerun's Mystic Waistband;
Command=/Use Ancient Hamerun's Necklace;
Command=/Use Ancient Hamerun's Ring;
Command=/Use Ancient Hamerun's Waistband;
Delay=500;
#ENDIF
_IFInventoryContains=125101720;
Command=/Use Cloth Bandana of the Wind;
Delay=500;
#ENDIF
_IFInventoryContains=125101721;
Command=/Use Cloth Headband of the Wind;
Delay=500;
#ENDIF
_IFInventoryContains=125101722;
Command=/Use Leather Hat of the Wind;
Delay=500;
#ENDIF
_IFInventoryContains=125101723;
Command=/Use Leather Headwear of the Wind;
Delay=500;
#ENDIF
_IFInventoryContains=125101724;
Command=/Use Chain Helm of the Wind;
Delay=500;
#ENDIF
_IFInventoryContains=125101725;
Command=/Use Chain Hood of the Wind;
Delay=500;
#ENDIF
_IFInventoryContains=125101726;
Command=/Use Plate Helm of the Wind;
Delay=500;
#ENDIF
_IFInventoryContains=125101727;
Command=/Use Plate Headwear of the Wind;
Delay=500;
#ENDIF
_IFInventoryContains=188070387;
UseID=188070387;
Delay=3500;
#ENDIF
_IFInventoryContains=188070398;
UseID=188070398;
Delay=3500;
Command=/Use Daeva Novice's Aether Key;
Command=/Use Daeva Novice's Plate Armour;
Command=/Use Daeva Novice's Plate Breeches;
Command=/Use Daeva Novice's Plate Gaiters;
Command=/Use Daeva Novice's Plate Protective Gloves;
Command=/Use Daeva Novice's Plate Spaulders;
Command=/Use Traveler's Cipher-Blade;
Command=/Use Traveler's Mystic Breastplate;
Command=/Use Traveler's Mystic Gauntlets;
Command=/Use Traveler's Mystic Greaves;
Command=/Use Traveler's Mystic Sabatons;
Command=/Use Traveler's Mystic Shoulderplates;
Delay=500;
#ENDIF
_IFInventoryContains=188070390;
UseID=188070390;
Delay=3500;
Command=/Use Daeva Novice's Dagger;
Command=/Use Daeva Novice's Leather Doublet;
Command=/Use Daeva Novice's Leather Legwear;
Command=/Use Daeva Novice's Leather Shoes;
Command=/Use Daeva Novice's Shoulder Straps;
Command=/Use Daeva Novice's Vambraces;
Command=/Use Traveler's Dagger;
Command=/Use Traveler's Boots;
Command=/Use Traveler's Breeches;
Command=/Use Traveler's Jerkin;
Command=/Use Traveler's Shoulderguards;
Command=/Use Traveler's Vambrace;
Delay=500;
#ENDIF
_IFInventoryContains=188070395;
UseID=188070395;
Delay=3500;
Command=/Use Daeva Novice's Cloth Breeches;
Command=/Use Daeva Novice's Cloth Gloves;
Command=/Use Daeva Novice's Cloth Shoes;
Command=/Use Daeva Novice's Cloth Shoulderpads;
Command=/Use Daeva Novice's Stringed Instrument;
Command=/Use Daeva Novice's Tunic;
Command=/Use Traveler's Gloves;
Command=/Use Traveler's Harp;
Command=/Use Traveler's Leggings;
Command=/Use Traveler's Pauldrons;
Command=/Use Traveler's Shoes;
Command=/Use Traveler's Tunic;
Delay=500;
#ENDIF
_IFInventoryContains=188070396;
UseID=188070396;
Delay=3500;
Command=/Use Daeva Novice's Brogans;
Command=/Use Daeva Novice's Chain Cuirass;
Command=/Use Daeva Novice's Chain Gauntlets;
Command=/Use Daeva Novice's Chausses;
Command=/Use Daeva Novice's Spaulders;
Command=/Use Daeva Novice's Staff;
Command=/Use Traveler's Brogans;
Command=/Use Traveler's Chausses;
Command=/Use Traveler's Handguards;
Command=/Use Traveler's Hauberk;
Command=/Use Traveler's Spaulders;
Command=/Use Traveler's Staff;
Delay=500;
#ENDIF
_IFInventoryContains=188070397;
UseID=188070397;
Delay=3500;
Command=/Use Daeva Novice's Chain Breeches;
Command=/Use Daeva Novice's Chain Gaiters;
Command=/Use Daeva Novice's Chain Protective Gloves;
Command=/Use Daeva Novice's Chain Shoulderplates;
Command=/Use Daeva Novice's Hauberk;
Command=/Use Daeva Novice's Mace;
Command=/Use Daeva Novice's Scale Shield;
Command=/Use Traveler's Mace;
Command=/Use Traveler's Mystic Brogans;
Command=/Use Traveler's Mystic Chausses;
Command=/Use Traveler's Mystic Handguards;
Command=/Use Traveler's Mystic Hauberk;
Command=/Use Traveler's Mystic Spaulders;
Command=/Use Traveler's Scale Shield;
Delay=500;
#ENDIF
_IFInventoryContains=188070389;
UseID=188070389;
Delay=3500;
Command=/Use Daeva Novice's Breastplate;
Command=/Use Daeva Novice's Plate Gauntlets;
Command=/Use Daeva Novice's Plate Greaves;
Command=/Use Daeva Novice's Polearm;
Command=/Use Daeva Novice's Sabatons;
Command=/Use Daeva Novice's Shoulderplates;
Command=/Use Traveler's Breastplate;
Command=/Use Traveler's Gauntlets;
Command=/Use Traveler's Greaves;
Command=/Use Traveler's Polearm;
Command=/Use Traveler's Sabatons;
Command=/Use Traveler's Shoulderplates;
Delay=500;
#ENDIF
_IFInventoryContains=188070392;
UseID=188070392;
Delay=3500;
Command=/Use Daeva Novice's Aether Revolver;
Command=/Use Daeva Novice's Breeches;
Command=/Use Daeva Novice's Jerkin;
Command=/Use Daeva Novice's Leather Epaulettes;
Command=/Use Daeva Novice's Leather Footwear;
Command=/Use Daeva Novice's Leather Gauntlets;
Command=/Use Traveler's Mystic Boots;
Command=/Use Traveler's Mystic Breeches;
Command=/Use Traveler's Mystic Jerkin;
Command=/Use Traveler's Mystic Shoulderguards;
Command=/Use Traveler's Mystic Vambrace;
Command=/Use Traveler's Pistol;
Delay=500;
#ENDIF
_IFInventoryContains=188071441;
UseID=188071441;
Delay=3500;
Command=/Use Daeva Novice's Cloth Epaulettes;
Command=/Use Daeva Novice's Cloth Jerkin;
Command=/Use Daeva Novice's Cloth Leg Protectors;
Command=/Use Daeva Novice's Cloth Sabatons;
Command=/Use Daeva Novice's Paint Rings;
Command=/Use Daeva Novice's Protective Mitts;
Command=/Use Traveler's Chromablaster;
Command=/Use Traveler's Martial Gloves;
Command=/Use Traveler's Martial Leggings;
Command=/Use Traveler's Martial Pauldrons;
Command=/Use Traveler's Martial Shoes;
Command=/Use Traveler's Martial Tunic;
Delay=500;
#ENDIF
_IFInventoryContains=188070391;
UseID=188070391;
Delay=3500;
Command=/Use Daeva Novice's Bow;
Command=/Use Daeva Novice's Leather Doublet;
Command=/Use Daeva Novice's Leather Legwear;
Command=/Use Daeva Novice's Leather Shoes;
Command=/Use Daeva Novice's Shoulder Straps;
Command=/Use Daeva Novice's Vambraces;
Command=/Use Traveler's Boots;
Command=/Use Traveler's Bow;
Command=/Use Traveler's Breeches;
Command=/Use Traveler's Jerkin;
Command=/Use Traveler's Shoulderguards;
Command=/Use Traveler's Vambrace;
Delay=500;
#ENDIF
_IFInventoryContains=188070393;
UseID=188070393;
Delay=3500;
Command=/Use Daeva Novice's Cloth Breeches;
Command=/Use Daeva Novice's Cloth Gloves;
Command=/Use Daeva Novice's Cloth Shoes;
Command=/Use Daeva Novice's Cloth Shoulderpads;
Command=/Use Daeva Novice's Spellbook;
Command=/Use Daeva Novice's Tunic;
Command=/Use Traveler's Gloves;
Command=/Use Traveler's Leggings;
Command=/Use Traveler's Pauldrons;
Command=/Use Traveler's Shoes;
Command=/Use Traveler's Spellbook;
Command=/Use Traveler's Tunic;
Delay=500;
#ENDIF
_IFInventoryContains=188070394;
UseID=188070394;
Delay=3500;
Command=/Use Daeva Novice's Cloth Breeches;
Command=/Use Daeva Novice's Cloth Gloves;
Command=/Use Daeva Novice's Cloth Shoes;
Command=/Use Daeva Novice's Cloth Shoulderpads;
Command=/Use Daeva Novice's Spellbook;
Command=/Use Daeva Novice's Tunic;
Command=/Use Traveler's Gloves;
Command=/Use Traveler's Leggings;
Command=/Use Traveler's Pauldrons;
Command=/Use Traveler's Shoes;
Command=/Use Traveler's Spellbook;
Command=/Use Traveler's Tunic;
Delay=500;
#ENDIF
_IFInventoryContains=188070388;
UseID=188070388;
Delay=3500;
Command=/Use Daeva Novice's Longsword;
Command=/Use Daeva Novice's Battle Shield;
Command=/Use Daeva Novice's Breastplate;
Command=/Use Daeva Novice's Plate Gauntlets;
Command=/Use Daeva Novice's Plate Greaves;
Command=/Use Daeva Novice's Sabatons;
Command=/Use Daeva Novice's Shoulderplates;
Command=/Use Traveler's Sword;
Command=/Use Traveler's Battle Shield;
Command=/Use Traveler's Breastplate;
Command=/Use Traveler's Gauntlets;
Command=/Use Traveler's Greaves;
Command=/Use Traveler's Sabatons;
Command=/Use Traveler's Shoulderplates;
Delay=500;
#ENDIF

end_CheckGear;

start_BlueQuestInstantReport;

FrameActionByName=quest_dialog,STATE,SHOW; opens quest window
FrameActionByName=quest_dialog,XPOS,0;
FrameActionByName=quest_dialog,YPOS,0;
Delay=550;
Mouse=71,41; select quest tab
Delay=400;
Mouse=113,86; select first quest
Delay=400;
MemPtrWrite=%AddrFrameName[quest_dialog],0x578,%Var[InstantReport],DWORD; writes quest ID internally
MemPtrWrite=%AddrFrameName[quest_dialog],0x588/0x28,7,BYTE; activates instant report button
Delay=450;
Mouse=151,330; Instant report
Delay=450;
Mouse=125,296; Optional Reward
Mouse=125,296; Optional Reward
Delay=500;
Mouse=%Var[ConfirmX],%Var[ConfirmY];
Mouse=%Var[ConfirmX],%Var[ConfirmY];

MemPtrWrite=%AddrFrameName[quest_dialog],0x28,142,BYTE; //Hide Quest window
MemPtrWrite=%AddrFrameName[quest_summary_dialog],0x28,142,BYTE; //Hide Quest Detail window

end_BlueQuestInstantReport;

start_CheckNpcNearMeGunes;

#DO=180000;
Command=/select %Var[Gunes];
Delay=150;
#UNTIL=%TargetDistance,<6;
#DO=30000;
Command=/attack;
Delay=7000;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=175;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=600;
DialogClick=;
Delay=500;
_UNTILMemPtrRead=%AddrFrameName[dlg_dialog],0x28,BYTE,=142;
#ENDIF

end_CheckNpcNearMeGunes;

start_ChangeChannel;

_MemReadVar=%AddrCurrentTime,WORD,27;

#IF=%Var27,0-13107;
Channel 1
#ENDIF

#IF=%Var27,13107-26213;
FrameActionByName=channel_dialog,STATE,SHOW;
FrameActionByName=channel_dialog,XPOS,0;
FrameActionByName=channel_dialog,YPOS,0;
Delay=550;
Mouse=110,36;
Delay=550;
Mouse=49,61; Channel 2
Delay=550;
Mouse=57,62;
MemPtrWrite=%PlayerBase,%OffsetAnim,0,WORD; <-- Activate NoAnim
#DO=30000;
Delay=250;
_UNTILMemPtrRead=%PlayerBase,%OffsetAnim,WORD,>0;
Delay=3000;
#ENDIF

#IF=%Var27,26214-39320;
FrameActionByName=channel_dialog,STATE,SHOW;
FrameActionByName=channel_dialog,XPOS,0;
FrameActionByName=channel_dialog,YPOS,0;
Delay=550;
Mouse=110,36;
Delay=550;
Mouse=49,70; Channel 3
Delay=550;
Mouse=57,62;
MemPtrWrite=%PlayerBase,%OffsetAnim,0,WORD; <-- Activate NoAnim
#DO=30000;
Delay=250;
_UNTILMemPtrRead=%PlayerBase,%OffsetAnim,WORD,>0;
Delay=3000;
#ENDIF

#IF=%Var27,39321-52427;
FrameActionByName=channel_dialog,STATE,SHOW;
FrameActionByName=channel_dialog,XPOS,0;
FrameActionByName=channel_dialog,YPOS,0;
Delay=550;
Mouse=110,36;
Delay=550;
Mouse=49,81; Channel 4
Delay=550;
Mouse=57,62;
MemPtrWrite=%PlayerBase,%OffsetAnim,0,WORD; <-- Activate NoAnim
#DO=30000;
Delay=250;
_UNTILMemPtrRead=%PlayerBase,%OffsetAnim,WORD,>0;
Delay=3000;
#ENDIF

#IF=%Var27,52428-65535;
FrameActionByName=channel_dialog,STATE,SHOW;
FrameActionByName=channel_dialog,XPOS,0;
FrameActionByName=channel_dialog,YPOS,0;
Delay=550;
Mouse=110,36;
Delay=550;
Mouse=49,91; Channel 5
Delay=550;
Mouse=57,62;
MemPtrWrite=%PlayerBase,%OffsetAnim,0,WORD; <-- Activate NoAnim
#DO=30000;
Delay=250;
_UNTILMemPtrRead=%PlayerBase,%OffsetAnim,WORD,>0;
Delay=3000;
#ENDIF

end_ChangeChannel;


start_CombatSort;


;;;;;;;;BASIC SETTINGS;;;;;;;;;;;

_IFMemPtrRead=%PlayerBase,%OffsetLevel,BYTE,<80;
#SkillLevelAccurate
#ENDIF
_ACUseAnimation=False;
#EXECUTE=Potion;
_ACTimeout=150000;

;;;;;;;END BASIC SETTINGS;;;;;;;;





_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=0;
;;;;;;;;;Settings Warrior;;;;;;;;;

_ACInitialRange=4;

_ACSkills=517,2865,2890;

;;;;;;;End Settings Warrior;;;;;;;
#ENDIF


_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=3;
;;;;;;;;;Settings Scout;;;;;;;;;

_ACManaPercentage=66;
_ACHealPercentage=50;

_ACInitialRange=4;

_ACBuffs=3235,3195;
_ACSkills=3197,3183;

;;;;;;;End Settings Scout;;;;;;;
#ENDIF


_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=6;
;;;;;;;;;Settings Mage;;;;;;;;;

_ACRelyOnBuff=1155,1155;

_ACInitialRange=25;

_ACBuffs=1155;
_ACSkills=1363,1447,1403,1282;

;;;;;;;End Settings Mage;;;;;;;
#ENDIF


_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=9;
;;;;;;;;;Settings Priest;;;;;;;;;

_ACRelyOnBuff=1684,1684;

_ACHealPercentage=30;

_ACInitialRange=5;

_ACHeals=1838;
_ACBuffs=1684;
_ACSkills=4012,1814,1615;
_ACRegenerate=1838;

;;;;;;;End Settings Priest;;;;;;;
#ENDIF

_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=10;
;;;;;;;;;Settings Cleric;;;;;;;;;

_IFMemPtrRead=%PlayerBase,%OffsetLevel,BYTE,>%Var[LevelCache];

_ACRelyOnBuff=1684,1684;

_ACHealPercentage=30;

_ACInitialRange=5;

_ACHeals=1841;
_ACBuffs=1684;
_ACSkills=4128,1816,4046,4062;
_ACRegenerate=1841;

_MemPtrReadVar=%PlayerBase,%OffsetLevel,BYTE,LevelCache;

;;;;;;;End Settings Cleric;;;;;;;
#ENDIF


_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=12;
;;;;;;;;;Settings Technist;;;;;;;;;

_ACInitialRange=25;

_ACBuffs=2169;
_ACSkills=2220,1942,1958;

;;;;;;;End Settings Technist;;;;;;;
#ENDIF


_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=15;
_IFMemRead=%AddrAtkspeed,WORD,>2399;
;;;;;;;;;Settings Artist / Songweaver;;;;;;;;;

_ACManaPercentage=30;

_ACInitialRange=25;

_ACHeals=4339;
_ACSkills=4409,4222;

;;;;;;;End Settings Artist / Songweaver;;;;;;;
#ENDIF


_IFMemPtrRead=%PlayerBase,%OffsetClassID,BYTE,=15;
_IFMemRead=%AddrAtkspeed,WORD,<2400;
;;;;;;;;;Settings Artist / Painter;;;;;;;;;

_ACInitialRange=25;

_ACSkills=5430,5442;

;;;;;;;End Settings Artist / Painter;;;;;;;
#ENDIF

_ACExperimentalCooldown=True; --- Please wait...

end_CombatSort;


start_Potion;

_IFInventoryContains=162005039,1;
_ACPotion=162005039,HP/MP,66,66;
#ENDIF

_IFInventoryContains=162000048,1;
_ACPotion=162000048,HP/MP,70,20;
#ENDIF

_IFInventoryContains=162005004,1;
_ACPotion=162005004,HP/MP,70,20;
#ENDIF

_IFInventoryContains=162005035,1;
_ACPotion=162005035,HP/MP,70,20;
#ENDIF

_IFInventoryContains=162000171,1;
_ACPotion=162000171,HP/MP,70,20;
#ENDIF

_IFInventoryContains=162005040,1;
_ACPotion=162005040,HP/MP,70,20;
#ENDIF

end_Potion;

start_RegenerateFunc;

_ACRegHPPercentage=%Var[HpSitting];
_ACRegMPPercentage=%Var[MpSitting];
_ACReg=;

end_RegenerateFunc;

start_DeclareStrings;

_IFMemRead=%AddrLangPack,CHAR[32],=L10N/ENG/;
_SetVar=Old Friend Royer,Old Friend Royer;
_SetVar=Pernos,Pernos;
_SetVar=Guide to Rare Poisons,Guide to Rare Poisons;
_SetVar=Day of the Storm,Day of the Storm;
_SetVar=Kasis,Kasis;
_SetVar=Exam Scarecrow,Exam Scarecrow;
_SetVar=Kalio,Kalio;
_SetVar=Melampus,Melampus;
_SetVar=Acting Royer,Acting Royer;
_SetVar=Forest Protector Noah,Forest Protector Noah;
_SetVar=Rooted Elder,Rooted Elder;
_SetVar=Branching Elder,Branching Elder;
_SetVar=Leafy Elder,Leafy Elder;
_SetVar=Daminu Flute,Daminu Flute;
_SetVar=Daminu,Daminu;
_SetVar=Investigating Royer,Investigating Royer;
_SetVar=Implementer Royer,Implementer Royer;
_SetVar=Odium Cauldron,Odium Cauldron;
_SetVar=Implementer Royer,Implementer Royer;
_SetVar=First Odium Transport Track,First Odium Transport Track;
_SetVar=Second Odium Transport Track,Second Odium Transport Track;
_SetVar=Ino,Ino;
_SetVar=Third Odium Transport Track,Third Odium Transport Track;
_SetVar=Haramel Secret Entrance,Haramel Secret Entrance;
_SetVar=Royer,Royer;
_SetVar=Belpartan,Belpartan;
_SetVar=Gruesome Oris,Gruesome Oris;
_SetVar=Raider,Raider;
_SetVar=Dukaki Watchman,Dukaki Watchman;
_SetVar=Dukaki Protector,Dukaki Protector;
_SetVar=Drudgelord Kakiti,Drudgelord Kakiti;
_SetVar=Tower Lift,Tower Lift;
_SetVar=MuMu Porter,MuMu Porter;
_SetVar=MuMu Mechanic,MuMu Mechanic;
_SetVar=MuMu Fighter,MuMu Fighter;
_SetVar=MuMu Ham the Grey,MuMu Ham the Grey;
_SetVar=Odella,Odella;
_SetVar=Gestanerk,Gestanerk;
_SetVar=Overseer Nukiti,Overseer Nukiti;
_SetVar=Hamerun the Bleeder,Hamerun the Bleeder;
_SetVar=Antique Treasure Chest,Antique Treasure Chest;
_SetVar=Haramel Exit,Haramel Exit;
_SetVar=ConfirmX,177;
_SetVar=ConfirmY,391;
_SetVar=Eli,Elly;
_SetVar=Old Stringed Instrument,Old Stringed Instrument;
_SetVar=Quest60000,<Pernos' Call>;
_SetVar=Quest60001,<A New Age>;
_SetVar=Quest60003,<The Strength to Become a Guardian>;
_SetVar=Quest60004,<The Attitude to Become a Guardian>;
_SetVar=Quest60005,<Special Mission>;
_SetVar=Quest60006,<Elim in Danger>;
_SetVar=Quest60007,<Forest Rescue>;
_SetVar=Quest60008,<Pursuit of the Odium Transport Track>;
_SetVar=Quest60009,<Haramel's Secret>;
_SetVar=Quest1006,<Last Test>;
_SetVar=MpSitting,35;
_SetVar=HpSitting,30;
_SetVar=Leah,Leah;
_SetVar=Jucleas,Jucleas;
_SetVar=Cloister of Kaisinel Teleport Statue,Cloister of Kaisinel Teleport Statue;
_SetVar=Eremitia,Eremitia;
_SetVar=Kaisinel,Kaisinel;
_SetVar=Polyidus,Polyidus;
_SetVar=Moorilerk,Moorilerk;
_SetVar=Aether Cart,Aether Cart;
_SetVar=Fine Odium,Fine Odium;
_SetVar=Raw Odium,Raw Odium;
_SetVar=Moofrenerk,Moofrenerk;
_SetVar=Processed Odella,Processed Odella;
_SetVar=Royer 2,Royer 2;
_SetVar=Sofne,Sofne;
_SetVar=Nekentos,Nekentos;
_SetVar=Gunes,Gunes;
_SetVar=Nargis,Nargis;
_SetVar=Loktania,Loktania;
_SetVar=Amene,Amene;
_SetVar=Aphesius,Aphesius;
_SetVar=Terentius,Terentius;
_SetVar=Scouting Royer,Scouting Royer;
_SetVar=Senea,Senea;
_SetVar=Splendora,Splendora;
_SetVar=Lyceum Teleport Statue,Lyceum Teleport Statue;
_SetVar=Riley,Riley;
_SetVar=Riala,Riala;
_SetVar=Uriel,Uriel;
_SetVar=Punctual Royer,Punctual Royer;
_SetVar=The Keykeeper,The Keykeeper;
_SetVar=Librarian Selima,Librarian Selima;
_SetVar=Lepharist Research Diary,Lepharist Research Diary;
_SetVar=Giant Flask,Giant Flask;
_SetVar=Hungry Mudthorn,Hungry Mudthorn;
_SetVar=Lepharist Research Data,Lepharist Research Data;
_SetVar=Perfected Pretor,Perfected Pretor;
_SetVar=RM-78c,RM-78c;
_SetVar=RM-108c,RM-108c;
_SetVar=Exit,Exit;
_SetVar=Battling Royer,Battling Royer;
_SetVar=loot_enabled,1;
#ENDIF


_IFMemRead=%AddrLangPack,CHAR[32],=L10N/ENU/;
_SetVar=Old Friend Royer,Old Friend Roye;
_SetVar=Pernos,Pernos;
_SetVar=Guide to Rare Poisons,Age of Dawn;
_SetVar=Day of the Storm,Day of the Storm;
_SetVar=Kasis,Kaisys;
_SetVar=Exam Scarecrow,Test Dummy;
_SetVar=Kalio,Kalio;
_SetVar=Melampus,Melampus;
_SetVar=Acting Royer,Traveling Roye;
_SetVar=Forest Protector Noah,Forest Protector Noah;
_SetVar=Rooted Elder,Stretch Root Elder;
_SetVar=Branching Elder,Great Branch Elder;
_SetVar=Leafy Elder,Thick Leaf Elder;
_SetVar=Daminu Flute,Daminu's Flute;
_SetVar=Daminu,Daminu;
_SetVar=Investigating Royer,Sleuthing Roye;
_SetVar=Implementer Royer,Determined Roye;
_SetVar=Odium Cauldron,Odium Cauldron;
_SetVar=Implementer Royer,Determined Roye;
_SetVar=First Odium Transport Track,First Odium Trace;
_SetVar=Second Odium Transport Track,Second Odium Trace;
_SetVar=Ino,Ino;
_SetVar=Third Odium Transport Track,Third Odium Trace;
_SetVar=Haramel Secret Entrance,Haramel Secret Entrance;
_SetVar=Royer,Roye;
_SetVar=Belpartan,Belpartan;
_SetVar=Gruesome Oris,Orissan;
_SetVar=Raider,Raider;
_SetVar=Dukaki Watchman,Dukaki Watchman;
_SetVar=Dukaki Protector,Dukaki Protector;
_SetVar=Drudgelord Kakiti,Drudgelord Kakiti;
_SetVar=Tower Lift,Tower Lift;
_SetVar=MuMu Porter,MuMu Porter;
_SetVar=MuMu Mechanic,MuMu Mechanic;
_SetVar=MuMu Fighter,MuMu Fighter;
_SetVar=MuMu Ham the Grey,MuMu Ham the Grey;
_SetVar=Odella,Odella;
_SetVar=Gestanerk,Gestanerk;
_SetVar=Overseer Nukiti,Bossman Nukiti;
_SetVar=Hamerun the Bleeder,Hamerun the Bleeder;
_SetVar=Antique Treasure Chest,Antique Treasure Chest;
_SetVar=Haramel Exit,Haramel Exit;
_SetVar=ConfirmX,196;
_SetVar=ConfirmY,394;
_SetVar=Eli,Eli;
_SetVar=Old Stringed Instrument,Old Harp;
_SetVar=Quest60000,<Meet Roye and Pernos>;
_SetVar=Quest60001,<Required Reading>;
_SetVar=Quest60003,<The First Test>;
_SetVar=Quest60004,<The Second Test>;
_SetVar=Quest60005,<A Forest in Need>;
_SetVar=Quest60006,<Elim in Danger>;
_SetVar=Quest60007,<The Music of the Elim>;
_SetVar=Quest60008,<Stealing is Okay Sometimes>;
_SetVar=Quest60009,<Scout's Honor>;
_SetVar=Quest1006,<Proving Your Worth>;
#ENDIF


end_DeclareStrings;



start_SetResolution; <-- resizes client without using real mouse

Console=\r_Height 600;
Console=\r_Width 800;

end_SetResolution;


start_LogOnCharacter;

#DO=15000;
Mouse=400,571; <-- Start
Delay=2000;
_UNTILMemRead=%AddrCharacterScene,BYTE,=5;<-CharacterScene
Delay=5000;
#DO=30000;
Delay=500;
SendKey=0x1B;
_UNTILMemPtrRead=%PlayerBase,%OffsetType,CHAR[6],=Player;
Delay=3500;

end_LogOnCharacter;



start_GoToCharScreen;

Command=/logout;
Delay=11000;
#DO=15000;
Delay=500;
_UNTILMemPtrRead=%PlayerBase,%OffsetName,BYTE,>0;
Delay=6000;
_IFMemRead=%AddrCharacterScene,DWORD,>0;
Delay=10000;
Command=/logout;
Delay=11000;
#DO=15000;
Delay=500;
_UNTILMemPtrRead=%PlayerBase,%OffsetName,BYTE,>0;
Delay=6000;
#ENDIF
_IFMemRead=%AddrCharacterScene,DWORD,>0;
_SetVar=MSG,Script got stucked and couldn't return to character selection, quiting now..;
#EXECUTE=DiscordPost;
#EXECUTE=End;
#ENDIF

end_GoToCharScreen;


start_ChangeCharacter;

Command=/logout;
Delay=30000; // 10 seconds to logout + 16 seconds locked from relog + 4 seconds tolerance
_SetVar=FailSelect,0;
#EXECUTE=SelectSlot;
Delay=2000;
Mouse=400,580; <-- Start
Delay=500;
Mouse=400,580; <-- Start
Delay=2000;
_IFFrameVisibleByName=second_password_dialog; PIN window
#EXECUTE=PINCheck;
#ENDIF
Delay=14000;

end_ChangeCharacter;


start_SelectSlot;

Mouse=694,190;
Delay=150;
_Calc10=%Var10-1;

MemWrite=%AddrFreeMem30,%AddrCharacterScene,DWORD;
_MemReadVar=%AddrFreeMem30,DWORD,CATempAddr;
_Calc[CATempAddr]=%Var[CATempAddr]-5728;

MemWrite=%Var[CATempAddr],%Var10,DWORD;

_Calc10=%Var10+1;

end_SelectSlot;


start_SelectClass;

#IF=%Var[NewClass],=1;
Mouse=95,508;
#ENDIF

#IF=%Var[NewClass],=2;
Mouse=95,508;
#ENDIF

#IF=%Var[NewClass],=3;
Mouse=231,508;
#ENDIF

#IF=%Var[NewClass],=4;
Mouse=231,508;
#ENDIF

#IF=%Var[NewClass],=5;
Mouse=364,508;
#ENDIF

#IF=%Var[NewClass],=6;
Mouse=364,508;
#ENDIF

#IF=%Var[NewClass],=7;
Mouse=497,508;
#ENDIF

#IF=%Var[NewClass],=8;
Mouse=497,508;
#ENDIF

#IF=%Var[NewClass],=9;
Mouse=632,508;
#ENDIF

#IF=%Var[NewClass],=10;
Mouse=632,508;
#ENDIF

#IF=%Var[NewClass],=11;
Mouse=763,508;
#ENDIF

#IF=%Var[NewClass],=12;
Mouse=763,508;
#ENDIF

end_SelectClass;


start_CreateCharacter;

#IF=%Var[NewClassCache],=13; // Random Class
_SetVar=NewClass,%RNG{1|12};
#EXECUTE=PickClass;
#ENDIF

#DO=60000;
Mouse=739,480; <-- Create Character
Delay=3500;
_UNTILMemRead=%AddrCharacterScene,BYTE,=1;<-CharacterScene
_IFFrameVisible=%ConfirmFrameID; confirm window
#EXECUTE=CheckFullAccount;
#ENDIF
#DO=60000;
Mouse=400,579; <-- Select faction
Delay=3500;
_UNTILMemRead=%AddrCharacterScene,BYTE,=2;<-CharacterScene
#DO=60000;
#EXECUTE=SelectClass;
Delay=2000;
Mouse=402,580; <-- Select class
Delay=3500;
_UNTILMemRead=%AddrCharacterScene,BYTE,=3;<-CharacterScene
Mouse=209,86; <-- Character name

_SetVar=temp,0;

#DO=300000;
Delay=500;
#IF=%Var[PreDeclaredNames],=0; // Random Generated
SendKey=%WRnd%WRnd%WRnd%WRnd%WRnd%WRnd%WRnd%WRnd%WRnd%WRnd;
#ENDIF
#IF=%Var[PreDeclaredNames],=1; // Names from ini file
#EXECUTE=EnterCharacterNameByFile;
#ENDIF
#IF=%Var[PreDeclaredNames],=2; // Names from online generator
_HTTPGetVar=https://behindthename.com/random/random.php?number=1&sets=1&gender=both&surname=&all=yes,,RandomName,<a class="plain" href="\/name\/.*">(.*?)<\/a> <\/span><\/div>;
SendKey=%Var[RandomName]%WRnd%WRnd%WRnd;
#ENDIF
Delay=3000;
Mouse=400,577;
Delay=4000;
_IFMemRead=%AddrCharacterScene,BYTE,=3;<-CharacterScene
Mouse=496,331;
Delay=500;
Mouse=209,86;
Delay=200;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
SendKey=0x08;
Delay=75;
#IF=%Var[PreDeclaredNames],=1; // Names from ini file
IniWrite=%VANILLATOOL\Logs\Settings\StarterClasses Names.ini,NameList,%Var[temp],; // removes name from ini file
#ENDIF
_UNTILMemRead=%AddrCharacterScene,BYTE,=0;<-CharacterScene

#IF=%Var[PreDeclaredNames],=1; // Names from ini file
IniWrite=%VANILLATOOL\Logs\Settings\StarterClasses Names.ini,NameList,%Var[temp],; // removes name from ini file
#ENDIF

Delay=4000;

end_CreateCharacter;


start_CheckFullAccount;

#IF=%Timer=1005,360000; // If more than 6 minutes have passed since last deleted character
_SetVar=MSG,Script filled all character slots, finished at %THour:%TMin:%TSec;
#EXECUTE=DiscordPost;
#EXECUTE=End;
#ELSE
#DO=360000;
Delay=1000;
#UNTIL=%Timer=1005,360000;
#DO=60000;
Mouse=739,480; <-- Create Character
Delay=3500;
_UNTILMemRead=%AddrCharacterScene,BYTE,=1;<-CharacterScene
#ENDIF

_IFFrameVisible=%ConfirmFrameID; confirm window
_SetVar=MSG,Script filled all character slots, finished at %THour:%TMin:%TSec;
#EXECUTE=DiscordPost;
#EXECUTE=End;
#ENDIF

end_CheckFullAccount;



start_EnterCharacterNameByFile;

_Calc[temp]=%Var[temp]+1;

#DO=60000;

IniRead=%VANILLATOOL\Logs\Settings\StarterClasses Names.ini,NameList,%Var[temp],tName;
#IF=%Var[tName],=; // If variable empty or not existing
_SetVar=tFound,0;
_Calc[temp]=%Var[temp]+1;
#ELSE
_SetVar=tFound,1;
#ENDIF

#UNTIL=%Var[tFound],=1;

#IF=%Var[tFound],=1; // if a name was found in namelist
SendKey=%Var[tName];
#ELSE
SendKey=%WRnd%WRnd%WRnd%WRnd%WRnd%WRnd%WRnd%WRnd%WRnd%WRnd;
#ENDIF

end_EnterCharacterNameByFile;


start_DeleteCharacter;

#IF=%Var[DeleteCharacters],=0;
#Return
#ENDIF

_Calc[ConfirmDelete]=%ConfirmFrameID+20;
MemWrite=%AddrFreeMem10,0,BYTE;
#DO=60000;
_IFFrameVisible=%Var[ConfirmDelete]; confirm delete window
MemWrite=%AddrFreeMem10,1,BYTE;
#ELSE
Mouse=785,477; <-- Delete Character
#ENDIF
Delay=750;
_UNTILMemRead=%AddrFreeMem10,BYTE,=1;
Delay=2000;


_IFFrameVisible=%Var[ConfirmDelete]; NA 6.2
#EXECUTE=DeleteDialog;
#ENDIF

end_DeleteCharacter;


start_DeleteDialog;

SendKey=confirm delete12345679123456791234567912345679;
Delay=4500;
_IFMemPtrRead=%AddrConfirmDelete,0x5E0/0x370/0x0,WCHAR[14],=confirm delete;
MemPtrWrite=%AddrConfirmDelete,0x5E0/0x370/0x0,Confirm Delete,WCHAR[32];
#ELSE
Mouse=510,258;
Delay=15;
Mouse=510,258;
Delay=15;
Mouse=510,258;
#EXECUTE=DeleteCharacter;
#Return
#ENDIF
Delay=1000;


MemWrite=%AddrFreeMem10,1,BYTE;
#DO=60000;
_IFFrameVisible=%Var[ConfirmDelete]; // confirm delete window
SendKey=0x0D;
Delay=500;
#ELSE
MemWrite=%AddrFreeMem10,0,BYTE;
#ENDIF
Delay=750;
_UNTILMemRead=%AddrFreeMem10,BYTE,=0;

MemWrite=%AddrFreeMem10,0,BYTE;
#DO=60000;
_IFFrameVisible=%ConfirmFrameID; // confirm window
MemWrite=%AddrFreeMem10,1,BYTE;
#ENDIF
Delay=750;
_UNTILMemRead=%AddrFreeMem10,BYTE,=1;

MemWrite=%AddrFreeMem10,1,BYTE;
#DO=60000;
_IFFrameVisible=%ConfirmFrameID; confirm window
SendKey=0x0D;
Delay=500;
#ELSE
MemWrite=%AddrFreeMem10,0,BYTE;
#ENDIF
Delay=750;
_UNTILMemRead=%AddrFreeMem10,BYTE,=0;

_IFFrameVisibleByName=second_password_dialog;
#EXECUTE=PINCheck;
#ENDIF

_Calc[DeletedCharacters]=%Var[DeletedCharacters]+1;
SetScriptTitle=%AionTitle - (%Var[CreatedCharacters]/%Var[DeletedCharacters]);
_SetVar=MSG,%Var[PlayerName] got deleted/nCreated Characters: %Var[CreatedCharacters]/nStucked Characters: %Var[DeletedCharacters];
#EXECUTE=DiscordPost;

Delay=3000;
CreateTimer=1005;

end_DeleteDialog;



start_PINCheck;

MemWrite=%AddrFreeMem10,1,BYTE;
#DO=60000;
_IFFrameVisibleByName=second_password_dialog; PIN window
Mouse=496,335;
Delay=50;
Mouse=460,347;
Delay=1000;
#EnterPIN=%Var[PIN];
Delay=1000;
SendKey=0x0D;
#ELSE
MemWrite=%AddrFreeMem10,0,BYTE;
#ENDIF
Delay=750;
_UNTILMemRead=%AddrFreeMem10,BYTE,=0;

end_PINCheck;



start_DisableClickToMove;

#DO=30000;
SendKey=0x4F;
Delay=600;
_UNTILMemPtrRead=%AddrFrameName[system_menu_dialog],0x28,BYTE,=175;
FrameActionByName=system_menu_dialog,XPOS,0;
FrameActionByName=system_menu_dialog,YPOS,0;
Delay=1500;
_IFMemRead=%AddrLangPack,CHAR[32],=L10N/ENU/;
Mouse=133,179; Options
#ELSE
Mouse=56,92; Options
#ENDIF
FrameActionByName=global_option_dialog,XPOS,0;
FrameActionByName=global_option_dialog,YPOS,0;
Delay=1500;
Mouse=59,158; Controls
Delay=50;
Mouse=59,158; Controls
Delay=600;
_IFMemRead=%AddrLangPack,CHAR[32],=L10N/ENU/;
Mouse=152,128; Click-To-Move
Delay=600;
Mouse=391,341; Apply
Delay=15;
Mouse=391,341; Apply
Delay=600;
Mouse=313,339; OK
#ELSE
Mouse=152,148; Click-To-Move
Delay=600;
Mouse=391,359; Apply
Delay=15;
Mouse=391,359; Apply
Delay=600;
Mouse=295,359; OK
#ENDIF
Delay=600;
_IFFrameVisibleByName=global_option_dialog;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
#ENDIF

_MemPattern=B1000000700072006500760065006E0074005F006D006F007500730065005F006D006F00760065,272,False,0x10000000/0x60000000; // Click to Move Pattern
#IF=%Var[PatternFound],=0;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
#Return
#ENDIF

_IFMemRead=%Var[PatternRet_1],DWORD,=0;
MemWrite=%Var[PatternRet_1],1,DWORD;
#ENDIF

_IFFrameVisibleByName=global_option_dialog;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
#ENDIF

end_DisableClickToMove;


start_ExpandInventory;

FrameActionByName=inventory_dialog,STATE,SHOW;
FrameActionByName=inventory_dialog,XPOS,0;
FrameActionByName=inventory_dialog,YPOS,0;
Delay=750;
Mouse=128,153;
Delay=750;
_IFFrameVisibleByName=choice_dialog;
FrameActionByName=choice_dialog,XPOS,0;
FrameActionByName=choice_dialog,YPOS,0;
Delay=750;
Mouse=59,103;
Delay=750;
Mouse=144,206;
Delay=750;
#ENDIF

FrameActionByName=inventory_dialog,STATE,SHOW;
FrameActionByName=inventory_dialog,XPOS,0;
FrameActionByName=inventory_dialog,YPOS,0;
Delay=750;
Mouse=128,181;
Delay=750;
_IFFrameVisibleByName=choice_dialog;
FrameActionByName=choice_dialog,XPOS,0;
FrameActionByName=choice_dialog,YPOS,0;
Delay=750;
Mouse=59,103;
Delay=750;
Mouse=144,206;
Delay=750;
#ENDIF

FrameActionByName=inventory_dialog,STATE,HIDE;

end_ExpandInventory;


start_SellToInventory;

#EXECUTE=GetInventoryItemArray;

SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;

_SetVar1=1;
_SetVar2=9999999;
#DO=60000;
_SetVar2=%Var2,%Var[InventoryID_%Var1];
_Calc1=%Var1+1;
#UNTIL=%Var1,>%Var[MaxSlots];
_SetArray1=%Var2;

FrameActionByName=inventory_attach_dialog,STATE,SHOW;
FrameActionByName=inventory_attach_dialog,XPOS,0;
FrameActionByName=inventory_attach_dialog,YPOS,0;
Delay=250;
Mouse=11,117;
Delay=750;
FrameActionByName=trade_dialog,XPOS,0;
FrameActionByName=trade_dialog,YPOS,0;
Delay=250;
SellItemsAtInventory=%ARRAY1,185,245;
SellItemsAtInventory=%ARRAY1,185,245;
SellItemsAtInventory=%ARRAY1,185,245;
Delay=250;
SellItemsAtInventory=%ARRAY1,185,245;
SellItemsAtInventory=%ARRAY1,185,245;
SellItemsAtInventory=%ARRAY1,185,245;
Delay=250;
SellItemsAtInventory=%ARRAY1,185,245;
SellItemsAtInventory=%ARRAY1,185,245;
Delay=250;
Mouse=229,246;

end_SellToInventory;


start_GetInventoryItemArray;

_SetVar=OffsetCube,1448;
_SetVar=OffsetSlot,0;
_SetVar=Counter,0;
_SetVar1=1;
_MemPtrReadVar=%AddrMaxSlots,%OffsetMaxSlots,BYTE,MaxSlots;

#DO=60000;

#2DO=60000;
_IFMemPtrRead=%AddrFrameName[inventory_dialog],%Var[OffsetCube]/0x3B8/%Var[OffsetSlot]/0x9C,DWORD,>0;
_MemPtrReadVar=%AddrFrameName[inventory_dialog],%Var[OffsetCube]/0x3B8/%Var[OffsetSlot]/0x9C,DWORD,InventoryID_%Var1;
_MemPtrReadVar=%AddrFrameName[inventory_dialog],%Var[OffsetCube]/0x3B8/%Var[OffsetSlot]/0x94,DWORD,InventoryHandle_%Var1;
_MemPtrReadVar=%AddrFrameName[inventory_dialog],%Var[OffsetCube]/0x3B8/%Var[OffsetSlot]/0xA8,DWORD,InventoryAmount_%Var1;
_MemPtrReadVar=%AddrFrameName[inventory_dialog],%Var[OffsetCube]/0x3B8/%Var[OffsetSlot]/0x50/0x0/0x0/0x0,WCHAR[64],InventoryName_%Var1;
#ELSE
_SetVar=InventoryID_%Var1,0;
_SetVar=InventoryHandle_%Var1,0;
_SetVar=InventoryAmount_%Var1,0;
_SetVar=InventoryName_%Var1,;
#ENDIF
_Calc[Counter]=%Var[Counter]+1;
_Calc[OffsetSlot]=%Var[Counter]*8;
_Calc1=%Var1+1;
#2UNTIL=%Var[Counter],>26;

_SetVar=Counter,0;
_SetVar=OffsetSlot,0;
_Calc[OffsetCube]=%Var[OffsetCube]+8;
#UNTIL=%Var1,>%Var[MaxSlots];

end_GetInventoryItemArray;

#################END Main Code##################

start_MapTeleport;

_IFMemPtrRead=%PlayerBase,%OffsetData/0x38,BYTE,=33;
SendKey=0x58;
Delay=2000;
#ENDIF

MemPtrWrite=%AddrFrameName[new_map_dialog],0x28,175,BYTE; // Show Map
MemPtrWrite=%AddrFrameName[new_map_dialog],0x6C,0,FLOAT; // Sets X Window Position of Map to 0
MemPtrWrite=%AddrFrameName[new_map_dialog],0x74,0,FLOAT; // Sets Y Window Position of Map to 0
MemPtrWrite=%AddrFrameName[new_map_dialog],0x528/0x84,2.6,FLOAT; // Resizes Map Width
MemPtrWrite=%AddrFrameName[new_map_dialog],0x528/0x9C,2.6,FLOAT; // Resizes Map Height

_IFMemPtrRead=%AddrFrameName[new_map_dialog],0x6C,FLOAT,=0; // IF Map window not expanded
Mouse=8,231;
#ENDIF

#EXECUTE=GetMapASM;
MemPtrWrite=%AddrFrameName[new_map_dialog],0x528/0x270,%Var[MTDestination],DWORD; // Writes Destination
Delay=50;
_SetVar=MTtemp,0;
#DO=5000;
MemPtrWrite=%AddrFrameName[new_map_dialog],0x528/0x270,%Var[MTDestination],DWORD; // Writes Destination
Mouse=194,65; // clicks at teleport icon
Mouse=194,65; // clicks at teleport icon
MemPtrWrite=%AddrFrameName[new_map_dialog],0x528/0x270,%Var[MTDestination],DWORD; // Writes Destination
Mouse=197,65; // clicks at teleport icon
Mouse=197,65; // clicks at teleport icon
MemPtrWrite=%AddrFrameName[new_map_dialog],0x528/0x270,%Var[MTDestination],DWORD; // Writes Destination
Mouse=197,68; // clicks at teleport icon
Mouse=197,68; // clicks at teleport icon
MemPtrWrite=%AddrFrameName[new_map_dialog],0x528/0x270,%Var[MTDestination],DWORD; // Writes Destination
Mouse=194,68; // clicks at teleport icon
Mouse=194,68; // clicks at teleport icon
MemPtrWrite=%AddrFrameName[new_map_dialog],0x528/0x270,%Var[MTDestination],DWORD; // Writes Destination
Delay=350;
_IFFrameVisible=%ConfirmFrameID;
_SetVar=MTtemp,1;
#ENDIF
#UNTIL=%Var[MTtemp],=1;
_IFFrameVisible=%ConfirmFrameID;
Delay=100;
SendKey=0x0D;
#ENDIF
_IFFrameVisible=%ConfirmFrameID;
#DO=20000;
Mouse=444,358;
_UNTILMemPtrRead=%AddrFrameID[%ConfirmFrameID],0x28,BYTE,=0;
#ENDIF

//Reset
MemWrite=%Var[MapASM1],0x48898B70020000,BYTE[7];
MemWrite=%Var[MapASM2],0x48898170020000,BYTE[7];
MemWrite=%Var[MapASM3],0x48898170020000,BYTE[7];
MemWrite=%Var[MapASM4],0x0F118370020000,BYTE[7];
MemWrite=%Var[MapASM5],0x48898370020000,BYTE[7];
MemPtrWrite=%AddrFrameName[new_map_dialog],0x528/0x84,3.86,FLOAT; // Resizes Map Width
MemPtrWrite=%AddrFrameName[new_map_dialog],0x528/0x9C,3.86,FLOAT; // Resizes Map Height
MemPtrWrite=%AddrFrameName[new_map_dialog],0x28,142,BYTE; // Hide Map

end_MapTeleport;



start_GetMapASM;

#IF=%Var[MTFoundAll],=0;
_MemPattern=48898B700200004889B38002,0,False,True;
_SetVar=MapASM1,%Var[PatternRet_1];

_MemPattern=48898170020000488981780200004889818002000048898188020000488981900200004885D2,0,False,True;
_SetVar=MapASM2,%Var[PatternRet_1];

_MemPattern=4889817002000048898178020000488981800200004889818802000048898190020000C3CCCC,0,False,True;
_SetVar=MapASM3,%Var[PatternRet_1];

_MemPattern=0F1047380F1183700200000F104F48,4,False,True;
_SetVar=MapASM4,%Var[PatternRet_1];

_MemPattern=48898370020000488983780200004889838002000048898388020000488983900200008B02,0,False,True;
_SetVar=MapASM5,%Var[PatternRet_1];

_SetVar=MTFoundAll,1;
#ENDIF

#IF=%Var[MTFoundAll],=1;
MemWrite=%Var[MapASM1],0x90909090909090,BYTE[7];
MemWrite=%Var[MapASM2],0x90909090909090,BYTE[7];
MemWrite=%Var[MapASM3],0x90909090909090,BYTE[7];
MemWrite=%Var[MapASM4],0x90909090909090,BYTE[7];
MemWrite=%Var[MapASM5],0x90909090909090,BYTE[7];
#ENDIF

end_GetMapASM;


start_DisableAnything;

_MemPtrReadVar=%PlayerBase,%OffsetData/0x256,BYTE,Dec;
#EXECUTE=DecToBin;

#IF=%Var[Bin128],=0;
Mouse=146,257; Block Mail From Players < lvl 10
Delay=600;
#ENDIF

#IF=%Var[Bin64],=0;
Mouse=146,238; Block Whispers From Players < lvl 15
Delay=600;
#ENDIF

#IF=%Var[Bin32],=0;
Mouse=145,220; Decline Duel Request
Delay=600;
#ENDIF

#IF=%Var[Bin16],=0;
Mouse=146,202; Decline Friend Registration
Delay=600;
#ENDIF

#IF=%Var[Bin8],=0;
Mouse=146,184; Decline Legion Invitation
Delay=600;
#ENDIF

#IF=%Var[Bin4],=0;
Mouse=150,169; Decline Groupe/Alliance Invitation
Delay=600;
#ENDIF

#IF=%Var[Bin2],=0;
Mouse=146,144; Decline Trade
Delay=600;
#ENDIF

#IF=%Var[Bin1],=0;
Mouse=145,127; Viewing Details
Delay=600;
#ENDIF

end_DisableAnything;

start_DecToBin;

_SetVar=Bin128,0;
_SetVar=Bin64,0;
_SetVar=Bin32,0;
_SetVar=Bin16,0;
_SetVar=Bin8,0;
_SetVar=Bin4,0;
_SetVar=Bin2,0;
_SetVar=Bin1,0;

#IF=%Var[Dec],>127;
_SetVar=Bin128,1;
_Calc[Dec]=%Var[Dec]-128;
#ENDIF
#IF=%Var[Dec],=0;
#Return
#ENDIF
#IF=%Var[Dec],>63;
_SetVar=Bin64,1;
_Calc[Dec]=%Var[Dec]-64;
#ENDIF
#IF=%Var[Dec],=0;
#Return
#ENDIF
#IF=%Var[Dec],>31;
_SetVar=Bin32,1;
_Calc[Dec]=%Var[Dec]-32;
#ENDIF
#IF=%Var[Dec],=0;
#Return
#ENDIF
#IF=%Var[Dec],>15;
_SetVar=Bin16,1;
_Calc[Dec]=%Var[Dec]-16;
#ENDIF
#IF=%Var[Dec],=0;
#Return
#ENDIF
#IF=%Var[Dec],>7;
_SetVar=Bin8,1;
_Calc[Dec]=%Var[Dec]-8;
#ENDIF
#IF=%Var[Dec],=0;
#Return
#ENDIF
#IF=%Var[Dec],>3;
_SetVar=Bin4,1;
_Calc[Dec]=%Var[Dec]-4;
#ENDIF
#IF=%Var[Dec],=0;
#Return
#ENDIF
#IF=%Var[Dec],>1;
_SetVar=Bin2,1;
_Calc[Dec]=%Var[Dec]-2;
#ENDIF
#IF=%Var[Dec],=0;
#Return
#ENDIF
#IF=%Var[Dec],>0;
_SetVar=Bin1,1;
_Calc[Dec]=%Var[Dec]-1;
#ENDIF

end_DecToBin;

start_DisableAllInvitesForLeveling;

_IFMemPtrRead=%PlayerBase,%OffsetData/0x256,BYTE,<255;
#DO=60000;
SendKey=0x4F;
FrameActionByName=system_menu_dialog,XPOS,0;
FrameActionByName=system_menu_dialog,YPOS,0;
Delay=1500;
Mouse=56,92; Options
FrameActionByName=global_option_dialog,XPOS,0;
FrameActionByName=global_option_dialog,YPOS,0;
Delay=1500;
Mouse=61,181; Community
Delay=50;
Mouse=61,181; Community
Delay=600;
#EXECUTE=DisableAnything;
Delay=600;
Mouse=391,359; Apply
Delay=15;
Mouse=391,359; Apply
Delay=600;
Mouse=295,359; OK
Delay=600;
_UNTILMemPtrRead=%PlayerBase,%OffsetData/0x256,BYTE,=255;
#ENDIF
_IFFrameVisibleByName=global_option_dialog;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
#ENDIF

end_DisableAllInvitesForLeveling;

start_HidePlayers;

_MemReadVar=%AddrFreeMem0,BYTE[4],CATempCache;
MemWrite=%AddrFreeMem0,%AddrFlightStatus,DWORD;
_MemReadVar=%AddrFreeMem0,DWORD,CATempAddr;
_Calc[CATempAddr]=%Var[CATempAddr]-10468;
MemWrite=%Var[CATempAddr],1,DWORD; <-- hides players
MemWrite=%AddrFreeMem0,%Var[CATempCache],BYTE[4];

end_HidePlayers;



start_ResetDialogPosition;

_IFMemPtrRead=%AddrFrameName[dlg_dialog],0x6C,FLOAT,=0;
MemPtrWrite=%AddrFrameName[dlg_dialog],0x6C,2.545898438,FLOAT;
MemPtrWrite=%AddrFrameName[dlg_dialog],0x74,3.321690083,FLOAT;
Delay=250;
#ENDIF

_IFMemPtrRead=%AddrFrameName[dlg_dialog],0x74,FLOAT,=0;
MemPtrWrite=%AddrFrameName[dlg_dialog],0x6C,2.545898438,FLOAT;
MemPtrWrite=%AddrFrameName[dlg_dialog],0x74,3.321690083,FLOAT;
Delay=250;
#ENDIF

end_ResetDialogPosition;

start_SheatheWeapon;

_IFMemPtrRead=%PlayerBase,%OffsetData/0x38,BYTE,=33;
#DO=3000;
UseID=50000;
Delay=1500;
_UNTILMemPtrRead=%PlayerBase,%OffsetData/0x38,BYTE,=1;
#ENDIF

end_SheatheWeapon;


start_CheckInstaScript;

#IF=%FirstTime,;
#IF=%IsInstaScript,=0; // If script got loaded manually
Ask=Declare settings manually?/n/n[No] or [Timeout] loads InstaScript settings;
#SetVar=CreateCharacters,Create as many characters as possible?/n/n1 = Yes/n0 = No;
#SetVar=DeleteCharacters,Delete failed characters?/n/n1 = Yes/n0 = No/n/n(not recommended if you have high level characters on the same server);
#SetVar=UserCube,Expand Inventory twice at the end?/n/n1 = Yes/n0 = No;
#SetVar=UserLuna,Accept Luna quests?/n/n1 = Yes/n0 = No;
#SetVar=UserPIN,Your PIN?/n/nExample: 0000001;
#SetVar=HidePlayers,Hide other Players?/n/n1 = Yes/n0 = No;
#SetVar=QuitClient,Exit Aion when script finished?/n/n1 = Yes/n0 = No;
#SetVar=Obelisk,Bind to Obelisk in Sanctum?/n/n1 = Yes/n0 = No;
#SetVar=PreDeclaredNames,Create new Characternames by../n0 = Random Generated/n1 = Retrieved from Namelist/n2 = Generated from online name generator;
#SetVar=NewClass,Create new Characters as../n1 = Gladiator/n2 = Templar/n3 = Assassin/n4 = Ranger/n5 = Sorcerer/n6 = Spiritmaster/n7 = Cleric/n8 = Chanter/n9 = Gunslinger (Recommended)/n10 = Aethertech/n11 = Songweaver/n12 = Painter/n13 = Random;
#SetVar=DiscordURL,Enter your Discord Webhook URL for Discord messages, otherwise enter 0/n/nMore information at https://bit.ly/2Q1YcqY );
#ENDIF

end_CheckInstaScript;


start_CheckUpdate;

_SetVar=ScriptVersion,0.80; // Script version
_HTTPGetVar=http://github.com/YokiVanillaCommunity/VanillaCommunityScripting/tree/master/Scripts,,LatestVersion,(?s)<a class="js-navigation-open " title="InstaScript_Elyos_1-21_Script-Ver(.*?)\.pscp" id=";
Delay=1000;
_HTTPGetVar=http://github.com/YokiVanillaCommunity/VanillaCommunityScripting/blob/master/Scripts/InstaScript_Elyos_1-21_Script-Changelog-Ver%Var[LatestVersion].txt,,Changelog,<td id="LC1" class="blob-code blob-code-inner js-file-line">(.*?)</td>;
#IF=%Var[ScriptVersion],<%Var[LatestVersion];
WaitForResponse=There's a newer Elyos_1-10_Script version available/nCurrent Version: %Var[ScriptVersion]/nLatest Version: %Var[LatestVersion]/n/nChangelogVer%Var[LatestVersion]:/n/n%Var[Changelog];
#ENDIF

end_CheckUpdate;


start_InstaScriptLogin;

#NeedResolution=816,638;
Delay=300;
#NeedResolution=816,638;
MemWrite=%AddrMouseX,0x00000000000000000000000000000000,BYTE[16]; // initialize mouse usage
MemPtrWrite=%AddrFPS,%OffsetFPS1,24,BYTE;FPS
MemPtrWrite=%AddrFPS,%OffsetFPS2,24,FLOAT;FPS

_IFMemRead=%AddrMap,DWORD,<999999999;
_IFMemRead=%AddrMap,DWORD,>0; // if already logged in
_MemPtrReadVar=%PlayerBase,%OffsetName,WCHAR[32],PlayerName;
SetScriptTitle=%AionTitle - (%Var[CreatedCharacters]/%Var[DeletedCharacters]);
#Return
#ENDIF

#DO=600000;
Delay=1500;
_UNTILMemRead=%AddrCharacterScene,DWORD,=5;
_IFMemRead=%AddrCharacterScene,DWORD,=5; // Accept EULA screen
#DO=600000;
Delay=1500;
_UNTILMemRead=%AddrMap,DWORD,=4294967295;
SetScriptTitle=%AionTitle - (%Var[CreatedCharacters]/%Var[DeletedCharacters]);
Delay=2500;
SendKey=0x0D; // Accept
Delay=6000;
#ENDIF
_IFMemRead=%AddrCharacterScene,DWORD,=5; // Select Server screen
Mouse=424,166; // Sort by Character
Delay=750;
Mouse=424,166; // Sort by Character
Delay=750;
Mouse=362,183; // First Server
Delay=750;
SendKey=0x0D; // Accept
Delay=5500;
#ENDIF
Mouse=403,580; // Start
Delay=500;
Mouse=403,580; // Start
Delay=2000;
MemWrite=%AddrFreeMem10,1,BYTE;
#DO=600000;
_IFFrameVisibleByName=second_password_dialog; PIN window
Mouse=496,335;
Delay=50;
Mouse=480,347;
Delay=1000;
FrameActionByName=second_password_dialog,XPOS,0;
FrameActionByName=second_password_dialog,YPOS,0;
#EnterPIN=%Var[UserPIN];
Delay=1000;
SendKey=0x0D;
Delay=6000;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
SendKey=0x1B;
Delay=50;
MemPtrWrite=%AddrESChwnd,%OffsetESChwnd,142,BYTE;
#ELSE
MemWrite=%AddrFreeMem10,0,BYTE;
#ENDIF
Delay=750;
_UNTILMemRead=%AddrFreeMem10,BYTE,=0;
Delay=14000;
_IFMemRead=%AddrMap,DWORD,>999999999; // not successfully logged in
#EXECUTE=End;
#ENDIF
_MemPtrReadVar=%PlayerBase,%OffsetName,WCHAR[32],PlayerName;
SetScriptTitle=%AionTitle - (%Var[CreatedCharacters]/%Var[DeletedCharacters]);

end_InstaScriptLogin;


start_End;

#IF=%Var[QuitClient],=1;
#QuitAtRound=-1,True;
#ELSE
_SetVar=MSG,Got stuck at Checkpoint 5 - Couldn't finish %Var[Quest60005];
#EXECUTE=DiscordPost;
#EXECUTE=GoToCharScreen;
#EXECUTE=DeleteCharacter;
#EXECUTE=CreateCharacter;
#EXECUTE=LogOnCharacter;
#Restart
#ENDIF

end_End;


start_DiscordPost;

MemWrite=%AddrFreeMem5,%Var[DiscordURL],WCHAR[1];
_IFMemRead=%AddrFreeMem5,BYTE,=104;
_MemPtrReadVar=%PlayerBase,%OffsetName,WCHAR[32],PlayerName;
_HTTPPost=http://subvanillatool.com/discord.php,url=%Var[DiscordURL]&message=__**[Starterclasses E] [%AionTitle::%Var[PlayerName]]**__ %Var[MSG];
#ENDIF

end_DiscordPost;


start_AccountSettings; // Customize PIN and character amount for each account here

_SetVar=IgnoreThis,0;

#IF=%AionTitle,=Account1; // IF window title = Account1 then
_SetVar=CharacterAmount,9; // Your Character amount
_SetVar=UserPIN,024689; // Your PIN
_Calc[IgnoreThis]=%Var[IgnoreThis]+1;
#ENDIF

#IF=%AionTitle,=Account2; // IF window title = Account2 then
_SetVar=CharacterAmount,11; // Your Character amount
_SetVar=UserPIN,111111; // Your PIN
_Calc[IgnoreThis]=%Var[IgnoreThis]+1;
#ENDIF

#IF=%AionTitle,=Account3; // IF window title = Account3 then
_SetVar=CharacterAmount,11; // Your Character amount
_SetVar=UserPIN,1234567; // Your PIN
_Calc[IgnoreThis]=%Var[IgnoreThis]+1;
#ENDIF



#IF=%Var[IgnoreThis],=0; // IF neither of them is found use default values from top of script
_SetVar=CharacterAmount,%Var[CharacterAmount];
_SetVar=UserPIN,%Var[UserPIN];
#ENDIF

end_AccountSettings;
